(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    208315,       5629]
NotebookOptionsPosition[    197415,       5448]
NotebookOutlinePosition[    197858,       5465]
CellTagsIndexPosition[    197815,       5462]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["SFS ratio modelling", "Title",
 CellChangeTimes->{{3.8957324228949823`*^9, 
  3.895732428075062*^9}},ExpressionUUID->"1603bf2d-a0c4-4a4d-8d3f-\
39e1292c55e9"],

Cell["\<\
Work on an idea for using the SFS to study selection on synonymous codon \
usage. 
Consider a particular kind of SNP  (e.g. CCC,CCT both for proline).  If this \
is under selection then the SFS for all such SNPs should be different than \
for control (neutral SNPs). 
This idea has been used before to estimate selection on codon usage, mostly \
in Drosophila (see various Petrov lab papers). 

But one issue is that the SFS also depends on demography, and we don\
\[CloseCurlyQuote]t want to have to include demography in any model.   We don\
\[CloseCurlyQuote]t have ways to estimate any/all demographic histories,  and \
even if we did,  estimating demography and selection together is complicated. 

The question is:  does the ratio of the SFSS (selected SFS) to the SFSN \
(neutral SFS) also depend on demography?  It almost certainly does,  but \
perhaps it depends much less on demography than the SFSS itself.
(note by \[OpenCurlyQuote]ratio\[CloseCurlyQuote] of SFSs I mean the ratio of \
the individual bins,  e.g. SFSS bin i divided by SFSN divide by bin i  etc. )\
\>", "Text",
 CellChangeTimes->{{3.8957324356968017`*^9, 3.8957325789028068`*^9}, {
  3.8957326657358327`*^9, 3.895733011753189*^9}, {3.8957616958971167`*^9, 
  3.895761697451619*^9}, {3.89576175678325*^9, 3.8957617916969757`*^9}, {
  3.895761860889128*^9, 3.895761871422968*^9}, {3.895847580359423*^9, 
  3.895847587616188*^9}, {3.895847620325554*^9, 3.895847633351665*^9}, {
  3.8963425980575657`*^9, 3.8963426797227917`*^9}, {3.8963427114032297`*^9, 
  3.896342746555663*^9}, {3.8963427886203976`*^9, 
  3.8963429757121253`*^9}},ExpressionUUID->"e831b98a-6ff8-4299-9a86-\
0bddc3548771"],

Cell["\<\
For example,  consider low frequency bins (singletons, doubletons etc)  which \
usually have the most SNPs because they include the rare alleles which tend \
to be young.   Selection against these low frequency alleles will push their \
frequencies down,  with the result that the relative height of the SFS for \
low frequency bins for deleterious alleles is elevated relative to neutral \
SFS for the same frequencies.   
They actual relative height of these SFS bins will depend strongly on \
demography,  but regardless of the demography,  perhaps the ratio of selected \
to neutral bin counts  will be mostly just sensitive to selection and not \
demography. \
\>", "Text",
 CellChangeTimes->{{3.8957324356968017`*^9, 3.8957325789028068`*^9}, {
  3.8957326657358327`*^9, 3.895733011753189*^9}, {3.8957616958971167`*^9, 
  3.895761697451619*^9}, {3.89576175678325*^9, 3.8957617916969757`*^9}, {
  3.895761860889128*^9, 3.895761871422968*^9}, {3.895847580359423*^9, 
  3.895847587616188*^9}, {3.895847620325554*^9, 3.895847633351665*^9}, {
  3.8963425980575657`*^9, 3.8963426797227917`*^9}, {3.8963427114032297`*^9, 
  3.896342746555663*^9}, {3.8963427886203976`*^9, 
  3.896342977536004*^9}},ExpressionUUID->"7011b62e-40df-4329-b111-\
5bf51e89fc2b"],

Cell[TextData[{
 "Lets for now suppose that we can lump all of demography,  mutational \
biases,  recombination-related effects (e.g. gene conversion), and background \
selection into one thing,  which we are going to call ",
 StyleBox["demography",
  FontSlant->"Italic"],
 ". ",
 "\nThen SFSS  (selected SFS) depends on selection ",
 StyleBox["and ",
  FontSlant->"Italic"],
 "demography, whereas the SFSN (neutral SFS) depends only on demography. \n\
The basic idea is that perhaps the ratio of SFSS over SFSN  is a function \
mostly of selection and not much else.\n\nWe\[CloseCurlyQuote]d have to test \
this with simulation. \n\nBut can we get the probability of the SFS ratio \
using basic Poisson random field theory?   (e.g. under a constant population \
size model with directional selection and no dominance)"
}], "Text",
 CellChangeTimes->{{3.8957324356968017`*^9, 3.8957325789028068`*^9}, {
  3.8957326657358327`*^9, 3.895733011753189*^9}, {3.8957616958971167`*^9, 
  3.895761697451619*^9}, {3.89576175678325*^9, 3.8957617916969757`*^9}, {
  3.895761860889128*^9, 3.895761871422968*^9}, {3.895847580359423*^9, 
  3.895847587616188*^9}, {3.895847620325554*^9, 3.895847633351665*^9}, {
  3.8963425980575657`*^9, 3.8963426797227917`*^9}, {3.8963427114032297`*^9, 
  3.896342746555663*^9}, {3.8963427886203976`*^9, 3.896342971422565*^9}, {
  3.896343011598916*^9, 
  3.896343012815527*^9}},ExpressionUUID->"a006e748-31ff-4eb6-b7ce-\
fca060487ba8"],

Cell[TextData[{
 "Consider bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "757e45ab-f0e2-43fc-b601-35c517613863"],
 " .  Let ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", 
    RowBox[{"S", ",", "i"}]], TraditionalForm]],ExpressionUUID->
  "6ccb4fd2-d36b-4418-8db8-6f9a1285f65e"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", 
    RowBox[{"N", ",", "i"}]], TraditionalForm]],ExpressionUUID->
  "cf54a804-0e87-4088-97b2-e7e92ef353ae"],
 " be the counts for bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "103a0fdf-4dfc-493a-aa9a-6cd1b04ab85e"],
 " in the selected and neutral observed SFSs, respectively.\nThen let  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "i"], "=", 
    RowBox[{
     SubscriptBox["C", 
      RowBox[{"S", ",", "i"}]], "/", 
     SubscriptBox["C", 
      RowBox[{"N", ",", "i"}]]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d0787ee8-a4d4-49c0-ae7d-512521b30188"],
 "  and consider that there are three components to this ratio:  (1) the \
ratio of the mutation rate of incoming mutations for each type that \
ultimately have the chance to end up in bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "42ba3ee2-e8d1-4748-b38f-910a15ac9e4e"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"S", ",", "i"}]], "/", 
    SubscriptBox["u", 
     RowBox[{"N", ",", "i"}]]}], TraditionalForm]],ExpressionUUID->
  "7d56f875-0330-4441-8789-aa5ce373b5e8"],
 " ,  which will be the same across allele frequency classes, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"S", ",", "i"}]], "/", 
     SubscriptBox["u", 
      RowBox[{"N", ",", "i"}]]}], "=", " ", 
    RowBox[{
     SubscriptBox["u", "S"], "/", 
     SubscriptBox["u", "N"]}]}], TraditionalForm]],ExpressionUUID->
  "51e0e11e-5ab2-4169-b0d3-fb030acc025f"],
 " ;  (2) a demography & linkage-effect scalar for bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bec8fe42-b0e0-4e0f-aa7b-fa366edc1cef"],
 " that is shared by both groups of variants,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["D", 
     RowBox[{"S", ",", "i"}]], "=", 
    SubscriptBox["D", 
     RowBox[{"N", ",", "i"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "99236122-04c3-4b68-90b5-7b48fa8c0d49"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["D", 
      RowBox[{"S", ",", "i"}]], "/", 
     SubscriptBox["D", 
      RowBox[{"N", ",", "i"}]]}], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"92595191-8a29-4be5-b4ff-85b8efd2d3c8"],
 ";  and (3) a term for the impact of direct selection on the non-neutral \
variants, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckS]", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "defdd36f-584d-4002-ac84-70f319e8a3ca"],
 ",  which depends upon the actual selection coefficient acting on the \
non-neutral variants, ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0f563fd4-ab12-4a1b-be7a-cdaf285413c3"],
 ".    If we assume that to a first approximation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckS]", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6160e821-ee56-4b8c-88d8-002cb6976ee9"],
 " acts independently of demography, then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "i"], "=", 
    RowBox[{
     SubscriptBox["\[DoubleStruckS]", "i"], 
     FractionBox[
      SubscriptBox["u", "S"], 
      SubscriptBox["u", "N"]]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a55d4f4b-4731-4fa8-8c8b-053d6a6312c8"],
 " .    Of course selection cannot act independently of demography.    \
However if we assume that ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "99819f8e-54bf-4981-a3e7-db901a0b7422"],
 " is constant across any subpopulations that might be present,  then the \
interaction between selection and demography can be captured using a term for \
the rate of genetic drift.  Regardless of the demography,  the changes in \
frequency of each selected variant depends on both the selection pressure \
(i.e. ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "87ae6d6a-561c-4919-a2ae-10de09c5db83"],
 ") and the population sampling variance from generation to generation,  i.e. \
the rate of genetic drift.    If we capture this sampling variance with a \
term for the effective number of gene copies,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", " ", "N"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "78d2fe6e-ccec-41c2-9c2c-c1fcdee81883"],
 ",  then the impact of selection will scale with both ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8cd4ea47-f024-4042-b68b-3a0471870111"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "N"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0a7eb9a3-4d79-422d-b03c-a4badb8c0769"],
 ".   In other words,   we can carry forward with an analysis of selection, \
in terms of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "N", " ", "s"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9b01b3c5-cb8c-4c49-82a6-eb7c180fa3c5"],
 ", as is always done when using PRF methods,  even though we have no idea of \
how demography or linkage is affecting the rate of genetic drift or the \
counts  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", 
    RowBox[{"S", ",", "i"}]], TraditionalForm]],ExpressionUUID->
  "496ed04a-282a-47d5-a35d-bd0188e2c15e"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", 
    RowBox[{"N", ",", "i"}]], TraditionalForm]],ExpressionUUID->
  "4374dae8-153a-47a5-882c-dcce72e95e3d"],
 " ."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQ7cH14XGz9FtH+Z3tr0G0w/LV70G0yTGLzyDa6uXm
3hVAerZl6XoQfXnZrM0g+hfDyb0gOmLd14Mg2lDY6TSInsV5/zyI7u0zuQui
E4Ktn4DonNMmn0G0u5rDdxB97Wj/TxA96VYDy0ogPcM8lRdEH1heIwiifyn0
g2mVgGpZEJ02ux9MvxOZpwyiH0+wUwXR69QPaYHoVa+XG4D1q3abgvWZtAeB
6GV/y8NA9J6XaRkg+nn3/VwQ3WFoVg+iBWWkm0E06+QVYPrCr6JuEH3vkvEK
EP2HN2YNiH5is+MwiJ7/ve4UiN7X4/oARE/SUnwGou9mxD0H0W/V2t6B6CmH
G7+AaABr37Or
  "],ExpressionUUID->"da5db689-f8c7-47d8-b2d4-6516208eea92"],

Cell[CellGroupData[{

Cell["\<\
Poisson random field model  (see e.g. Sethupathy, P., and S. Hannenhalli. \
2008)\
\>", "Chapter",
 CellChangeTimes->{{3.60496266781184*^9, 3.604962681023859*^9}, {
  3.895736678372528*^9, 3.895736691538796*^9}, {3.8957367609132824`*^9, 
  3.8957367831942644`*^9}},ExpressionUUID->"502ac572-4179-45a6-8047-\
ffd205de4fe5"],

Cell[TextData[{
 "The PRF model has two main insights.  First,  the diffusion math that leads \
to the expression for the \[OpenCurlyDoubleQuote]transient distribution\
\[CloseCurlyDoubleQuote],  the distribution of allele frequencies across \
sites (",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", ")"}], TraditionalForm]],ExpressionUUID->
  "8fefeb26-f7ee-436d-aa52-4f67f3c691a0"],
 " above).  Second,  the idea that integrating this over binomial sampling \
generates a value that can be treated as a rate in a Poisson distribution.  \n\
If the second part of this is independent of the first - i.e. if it is true \
that so long as we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", ")"}], TraditionalForm]],ExpressionUUID->
  "056c42bd-5a91-4a49-9145-9783ee91c0e3"],
 " for our population model,  whatever it is,  then we can still plug it into \
the Poisson term.  If this is the case,  then we can still use Poisson \
distributions,  or ratios of them, for inference of selection. "
}], "Text",
 CellChangeTimes->{{3.8958213197642345`*^9, 3.895821349807272*^9}, {
  3.895821574319499*^9, 3.895821705922712*^9}, {3.895821741663333*^9, 
  3.895821774559185*^9}, {3.8958221060098376`*^9, 3.895822157988183*^9}, {
  3.9011771331571617`*^9, 
  3.9011771361393957`*^9}},ExpressionUUID->"bbe9f06d-c3f8-41c6-bcf8-\
714907c8c5fb"],

Cell[TextData[{
 "\nWright Fisher Model \nassumptions: (1) non-overlapping generations (not \
usually important); (2) constant N; (3) random mating. \n\nThe mean time to \
absorption (fix or loss) for an allele that started at frequency ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "a68c1a9a-8d63-4af5-987d-1b48abae17bc"],
 " and is now at frequency ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],ExpressionUUID->
  "e103423b-4564-42df-bb16-cc308c99b6e5"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{"q", ",", "\[Gamma]"}], ")"}], "\[TildeTilde]", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"\[Gamma]", "(", 
          RowBox[{"1", "-", "q"}], ")"}]}]]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], "\[Gamma]"}]]}], ")"}], 
      RowBox[{"q", "(", 
       RowBox[{"1", "-", "q"}], ")"}]}]]}], TraditionalForm]],ExpressionUUID->
  "f19cccd7-910a-4095-b163-0fe6c1ee15b9"],
 "\t\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Gamma]", "=", 
    RowBox[{"2", "N", " ", "s"}]}], TraditionalForm]],ExpressionUUID->
  "3f2db346-e07f-4cf8-a161-945c0a2c16b4"],
 " "
}], "Text",
 CellChangeTimes->{{3.6049626914248734`*^9, 3.6049629133991857`*^9}, {
   3.604962955644245*^9, 3.6049630458643723`*^9}, {3.6049630785584183`*^9, 
   3.6049630988604465`*^9}, {3.604963438497924*^9, 3.6049634406879272`*^9}, {
   3.604964829657915*^9, 3.604964838378927*^9}, {3.892821862377769*^9, 
   3.89282186540936*^9}, {3.892821909218752*^9, 3.8928219130753355`*^9}, {
   3.8957367262465086`*^9, 3.8957367583727713`*^9}, {3.896343024063822*^9, 
   3.8963430397120733`*^9}, {3.900828148629528*^9, 3.900828182364999*^9}, 
   3.900829100326795*^9, 
   3.901177120601723*^9},ExpressionUUID->"9d119165-1dd9-426d-9599-\
508d2c7af1b7"],

Cell[TextData[{
 "Sawyer and Hartl noticed that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "q", ")"}], ",", "\[Gamma]"}], TraditionalForm]],
  ExpressionUUID->"3da554a2-87e4-4d30-82c0-e6659a6d5d6b"],
 " could be interpreted so that\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["q", "1"], 
     SubscriptBox["q", "2"]], 
    RowBox[{"\[Theta]", " ", 
     RowBox[{"f", "(", 
      RowBox[{"q", ",", "\[Gamma]"}], ")"}], 
     RowBox[{"\[DifferentialD]", "q"}]}]}], TraditionalForm]],ExpressionUUID->
  "d483d5b3-da7c-4d9c-9550-82146841a786"],
 "  \t\t\t\t\nIs the expected number of sites in the population with derived \
allele frequency between ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "2bf1db27-d1e8-487d-a5f0-1febd677fe73"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "2"], TraditionalForm]],ExpressionUUID->
  "9c66975f-4ce4-44e4-97c0-e95cc601c325"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "=", 
    RowBox[{"4", "N", " ", "u"}]}], TraditionalForm]],ExpressionUUID->
  "53fcc9cc-3981-4188-9e95-f4eda9608ece"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", " ", 
    RowBox[{"f", "(", 
     RowBox[{"q", ",", "\[Gamma]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"ab6db06f-4f21-44d8-8971-a78a6451ee44"],
 " is the expected density function (i.e. equilibrium density) for derived \
allele frequencies.  \n\nImportantly ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],ExpressionUUID->
  "a2f6e3df-7391-4da9-9d61-b77c61155dad"],
 " is the population frequency. We have to add sampling to get sample \
frequencies. \nThe probability of sampling ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "43823a27-2fb5-4f4a-81e6-5702caa91eb7"],
 " copies (",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "-", "i"}], TraditionalForm]],ExpressionUUID->
  "c8db0fb5-0b7c-4d52-9cc5-2a999ea95372"],
 " copies of the ancestral allele) is \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "1"], 
     RowBox[{
      RowBox[{"f", "(", 
       RowBox[{"q", ",", "\[Gamma]"}], ")"}], 
      RowBox[{"P", "(", 
       RowBox[{"i", "|", "q"}], ")"}], 
      RowBox[{"\[DifferentialD]", "q"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"af94f300-256c-4130-8bd2-1402f57e77ef"],
 "  where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{"i", "|", "q"}], ")"}], " "}], TraditionalForm]],ExpressionUUID->
  "7c7289f6-26e3-4b3c-9e9c-51017f73866b"],
 "is the binomial sampling probability. \n\n\nThen ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", " ", 
    RowBox[{"F", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"72a02680-19bc-4ccc-98ae-7723b9746825"],
 " can be treated like a rate and can be put in a Poisson distribution. \n\n\
It is important to appreciate that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"F", "[", 
    RowBox[{"i", ",", "\[Gamma]"}], "]"}], TraditionalForm]],ExpressionUUID->
  "44c9ab90-0701-4de8-a55c-286b8632e5a8"],
 " is not a fixed quantity, but varies with ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "41c6782c-3ac4-4221-87b2-d478910f7552"],
 ". \nFor bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "79108f2c-d032-4039-ac91-a0971f1780a5"],
 " the expectation is just ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", " ", 
    RowBox[{"F", "[", 
     RowBox[{"i", ",", "\[Gamma]"}], "]"}]}], TraditionalForm]],
  ExpressionUUID->"2755b876-a3df-4282-a810-a2251c9a52ce"],
 " \n\n\nThen the probability of observing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "i"], TraditionalForm]],ExpressionUUID->
  "3c6ae09e-99dc-4a6b-bce8-edd83cdf9c01"],
 " sites with ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "46d96546-5743-4969-9a53-e103198074a9"],
 " derived copies is \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["X", "i"], "=", 
       RowBox[{
        SubscriptBox["x", "i"], "|", "\[Theta]"}]}], ",", "\[Gamma]"}], ")"}],
     "=", 
    FractionBox[
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Theta]"}], " ", 
         RowBox[{"F", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "(", 
       RowBox[{"\[Theta]", " ", 
        RowBox[{"F", "(", 
         RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
      SubscriptBox["x", "i"]], 
     RowBox[{
      SubscriptBox["x", "i"], "!"}]]}], TraditionalForm]],ExpressionUUID->
  "150202b1-7ead-4873-a586-48c35401b00d"],
 "   (expression (3)) \nSo a data set consists of a bunch of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "i"], TraditionalForm]],ExpressionUUID->
  "f2bfee57-4467-40ea-8e8a-c0200421b4c9"],
 " values where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{
     RowBox[{"...", "n"}], "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "029c9aae-e5db-4e15-b18f-8b1a7ea41cdd"],
 "  in the unfolded model \ni.e.  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"L", "(", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{"\[Gamma]", "|", "X"}]}], ")"}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "-", "1"}]], 
     FractionBox[
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[Theta]"}], " ", 
          RowBox[{"F", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "(", 
        RowBox[{"\[Theta]", " ", 
         RowBox[{"F", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
       SubscriptBox["x", "i"]], 
      RowBox[{
       SubscriptBox["x", "i"], "!"}]]}]}], TraditionalForm]],ExpressionUUID->
  "e4919d6f-1e05-49da-80e5-5fbdcba209da"]
}], "Text",
 CellChangeTimes->{{3.6049658220203104`*^9, 3.604965827361318*^9}, {
   3.604966007712572*^9, 3.6049661162047243`*^9}, {3.6049661506777725`*^9, 
   3.6049661894338274`*^9}, {3.892820715257493*^9, 3.8928207521852713`*^9}, {
   3.892821222731608*^9, 3.892821271036702*^9}, {3.8928213442047186`*^9, 
   3.892821398220025*^9}, {3.8928214702292795`*^9, 3.892821593649423*^9}, {
   3.892821633090165*^9, 3.892821648590603*^9}, {3.8928216987031107`*^9, 
   3.892821816927553*^9}, {3.892821978148059*^9, 3.892822005547213*^9}, 
   3.892822036496767*^9, {3.8928220950417414`*^9, 3.89282214344637*^9}, {
   3.892822197938811*^9, 3.892822212021909*^9}, {3.892823183941673*^9, 
   3.8928234891118174`*^9}, {3.8928235769206123`*^9, 3.8928235810486565`*^9}, 
   3.8941248315273447`*^9, {3.8957368481101065`*^9, 3.8957368515864754`*^9}, {
   3.8957369084955506`*^9, 3.8957369197392073`*^9}, {3.895737134099229*^9, 
   3.895737134662041*^9}, 3.8963430800816536`*^9, {3.90042651106653*^9, 
   3.9004265321708665`*^9}, {3.9008282101737647`*^9, 
   3.9008282180840197`*^9}, {3.9008291172051806`*^9, 3.900829122591547*^9}, {
   3.9008292054879303`*^9, 
   3.900829211972484*^9}},ExpressionUUID->"2d82636e-4e84-430c-8d92-\
f2dac7f39f6f"],

Cell[CellGroupData[{

Cell["Invariant sites", "Subsubsection",
 CellChangeTimes->{{3.900426539498932*^9, 
  3.9004265411488*^9}},ExpressionUUID->"d73cb3b0-593f-4cb7-9d55-c68d79e3dfe1"],

Cell["\<\
Is this of any use for telling us about invariant sites?  
Mostly not, at least for neutral sites. 
For one things,  the math assumes an infinite sites model,  and so in this \
case there are an infinity of invariant sites. \
\>", "Text",
 CellChangeTimes->{{3.90042641975132*^9, 3.900426462215723*^9}, {
  3.900426493177453*^9, 3.9004264978656206`*^9}, {3.9004265464589167`*^9, 
  3.900426553835613*^9}},ExpressionUUID->"1545e44e-f01b-4ead-82aa-\
c92164bf6d85"],

Cell["\<\

But for selected sites, we can get an expectation for the number of sites \
that are non-segregating because of selection? 

These are the sites that would have been segregating if they were all \
neutral.   (not those that are invariant because a mutation did not happen, \
or because it happened and fixed) \
\>", "Text",
 CellChangeTimes->{{3.9004222880653715`*^9, 3.9004224665018935`*^9}, {
   3.90042412070452*^9, 3.900424378098503*^9}, {3.9004258047673693`*^9, 
   3.900425811391672*^9}, 3.9004264135100727`*^9, 3.900426504252095*^9, {
   3.900426563677452*^9, 3.9004265949091825`*^9}, {3.900509109470173*^9, 
   3.9005092687774763`*^9}, {3.9005093400518723`*^9, 
   3.9005093476320124`*^9}, {3.900509394297205*^9, 3.9005095185782433`*^9}, {
   3.900509581192135*^9, 3.9005096607499824`*^9}, {3.9005097095780687`*^9, 
   3.9005097364710093`*^9}, {3.900509783065699*^9, 
   3.9005098443426285`*^9}},ExpressionUUID->"1af86d43-db24-4e9c-82f4-\
8a92ccc6985a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Is it possible to remove one of the \[Theta] terms from the optimization? \
\>", "Subsubsection",
 CellChangeTimes->{{3.9005098504001637`*^9, 
  3.9005098739927607`*^9}},ExpressionUUID->"b14de8df-be89-4b6d-b942-\
b73359ce90e1"],

Cell[TextData[{
 "Under the Fisher-Wright model,  we expect ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "/", "i"}], TraditionalForm]],ExpressionUUID->
  "9959a7a4-ed62-4234-bf28-7b22af00a1c5"],
 "  sites in class ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "2cb26e89-b601-4bc4-9d09-765ccbd2348c"],
 "  if there is no selection,  but instead we get ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", " ", 
    RowBox[{"F", "[", 
     RowBox[{"i", ",", "\[Gamma]"}], "]"}]}], TraditionalForm]],
  ExpressionUUID->"84a50057-cb58-410b-a6e8-d3c513b95f29"],
 "\nSo the expected total number that are missing because selection removed \
them is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], 
     RowBox[{"n", "-", "1"}]], 
    RowBox[{"\[Theta]", "(", 
     RowBox[{
      FractionBox["1", "i"], "-", 
      RowBox[{"F", "[", 
       RowBox[{"i", ",", "\[Gamma]"}], "]"}]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"a4c462b2-71b2-4370-b235-4f704d23da99"],
 "\nIf we have a selected \[Theta], ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "S"], TraditionalForm]],ExpressionUUID->
  "25f18e62-a26b-4e3c-bb31-f4a204e979ed"],
 " and a neutral \[Theta], ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "N"], TraditionalForm]],ExpressionUUID->
  "b582e51a-f408-4ed6-b892-b5f8f668fb1e"],
 "  then we can estimate the ratio ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "S"], "/", 
    SubscriptBox["\[Theta]", "N"]}], TraditionalForm]],ExpressionUUID->
  "91711b2a-b6a2-42a2-b0e4-97143a5176f4"],
 " for a given \[Gamma] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"=", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "S"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "1"}], 
         RowBox[{"n", "-", "1"}]], 
        RowBox[{"F", "[", 
         RowBox[{"i", ",", "\[Gamma]"}], "]"}]}]}], ")"}], 
     RowBox[{
      SubscriptBox["\[Theta]", "N"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"n", "-", "1"}]], 
       RowBox[{"1", "/", "i"}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "26ab20e7-00f8-49fe-9288-0e0d45ea7c1c"],
 "\n\nLet ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", 
    RowBox[{"S", ",", "i"}]], TraditionalForm]],ExpressionUUID->
  "2be5aba7-b8c4-42ab-834b-e80e2b63ef1f"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", 
    RowBox[{"N", ",", "i"}]], TraditionalForm]],ExpressionUUID->
  "b02fa0c2-d18f-4492-8553-ecaf329f89a3"],
 " be the counts for bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "6688f63f-eaf7-44ed-bf1f-31c67d2f6c09"],
 " in the selected and neutral observed SFSs, respectively.\nand ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "S"], "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "-", "1"}]], 
     SubscriptBox["C", 
      RowBox[{"S", ",", "i"}]]}]}], TraditionalForm]],ExpressionUUID->
  "d7b01863-ebb2-4c9f-a594-9080ebbdc4c5"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "N"], "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "-", "1"}]], 
     SubscriptBox["C", 
      RowBox[{"N", ",", "i"}]]}]}], TraditionalForm]],ExpressionUUID->
  "3aacff6b-f42c-4fe7-82b5-43640e868a42"],
 " be the total counts for each. \nThen when we have a good estimate it \
should be true that \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     SubscriptBox["C", "S"], 
     SubscriptBox["C", "N"]], "=", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "S"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "1"}], 
         RowBox[{"n", "-", "1"}]], 
        RowBox[{"F", "[", 
         RowBox[{"i", ",", "\[Gamma]"}], "]"}]}]}], ")"}], 
     RowBox[{
      SubscriptBox["\[Theta]", "N"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"n", "-", "1"}]], 
       RowBox[{"1", "/", "i"}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "95762d95-e5b4-4937-a254-3b6a0a6c3190"],
 "\nFor a given value of \[Gamma] then we can solve for one of the \[Theta] \
terms. \nLet ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", 
    FractionBox[
     RowBox[{
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"n", "-", "1"}]], 
       RowBox[{"F", "[", 
        RowBox[{"i", ",", "\[Gamma]"}], "]"}]}], ")"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], 
       RowBox[{"n", "-", "1"}]], 
      RowBox[{"1", "/", "i"}]}]]}], TraditionalForm]],ExpressionUUID->
  "df64b362-ba3d-4304-bb0d-3da5a21354c9"],
 "\nthen ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     SubscriptBox["C", "S"], 
     SubscriptBox["C", "N"]], "=", 
    FractionBox[
     RowBox[{"\[Zeta]", " ", 
      SubscriptBox["\[Theta]", "S"]}], 
     SubscriptBox["\[Theta]", "N"]]}], TraditionalForm]],ExpressionUUID->
  "d0102ddc-db68-4581-8ce0-ba034e23bef2"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "N"], "\[Rule]", 
    FractionBox[
     RowBox[{"\[Zeta]", " ", 
      SubscriptBox["C", "N"], " ", 
      SubscriptBox["\[Theta]", "S"]}], 
     SubscriptBox["C", "S"]]}], TraditionalForm]],ExpressionUUID->
  "baaaa761-1b45-44a5-bb17-751be7b0d82b"],
 " is an estimate of \[Zeta]\nThis assumes Fisher-Wright,  but  a similar \
argument as that used in support of using the ratio of snp counts would apply \
here.  Selection may change the shape of the SFS,  but if it does not change \
the snp count,  then this should be ok. "
}], "Text",
 CellChangeTimes->{{3.9004222880653715`*^9, 3.9004224665018935`*^9}, {
   3.90042412070452*^9, 3.900424378098503*^9}, {3.9004258047673693`*^9, 
   3.900425811391672*^9}, 3.9004264135100727`*^9, 3.900426504252095*^9, {
   3.900426563677452*^9, 3.9004265949091825`*^9}, {3.900509109470173*^9, 
   3.9005092687774763`*^9}, {3.9005093400518723`*^9, 
   3.9005093476320124`*^9}, {3.900509394297205*^9, 3.9005095185782433`*^9}, {
   3.900509581192135*^9, 3.9005096607499824`*^9}, {3.9005097095780687`*^9, 
   3.9005097364710093`*^9}, {3.900509783065699*^9, 3.900509831688106*^9}, {
   3.900509883258299*^9, 3.90050996612416*^9}, {3.9005100275862837`*^9, 
   3.9005100406905518`*^9}, {3.900682179615051*^9, 
   3.9006822578454638`*^9}},ExpressionUUID->"163f74e2-07f3-4a2e-96ef-\
e1b00f5b9c8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The meaning of \[Theta]", "Subsubsection",
 CellChangeTimes->{{3.9004266910085754`*^9, 
  3.900426695890793*^9}},ExpressionUUID->"9d6dc7ef-bc64-4156-9f19-\
e296c3ea8f16"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "=", 
    RowBox[{"4", " ", "N", " ", "u"}]}], TraditionalForm]],ExpressionUUID->
  "4da782ee-f1ec-472b-bbb9-773e0379f66b"],
 "  is the main parameter setting the number of segregating sites. \nGetting \
back to the coalescent under Fisher-Wright,   the expected time to the next \
common ancestor when there are ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "bf38b455-362b-4cda-9f6c-1bf9225ef8ba"],
 " copies is \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"2", "N"}], 
     RowBox[{
      RowBox[{"i", "(", 
       RowBox[{"i", "-", "1"}], ")"}], "/", "2"}]], "=", 
    FractionBox[
     RowBox[{"4", "N"}], 
     RowBox[{"i", "(", 
      RowBox[{"i", "-", "1"}], ")"}]]}], TraditionalForm]],ExpressionUUID->
  "4bfe930b-73ce-47f9-bb12-aaa283de4513"],
 "\nAnd the expected length of the tree due to this interval is just ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"i", " ", 
     FractionBox[
      RowBox[{"4", "N"}], 
      RowBox[{"i", "(", 
       RowBox[{"i", "-", "1"}], ")"}]]}], "=", 
    FractionBox[
     RowBox[{"4", "N"}], 
     RowBox[{"i", "-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "9009643c-5f09-460d-97d6-8b10ecd442cd"],
 ".  \nIf we sum this as i goes from ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "c0830559-c336-4675-aa01-227e38f32bb0"],
 " down to 2 we get the classic ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", "N", " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "-", "1"}]], 
     FractionBox["1", "i"]}]}], TraditionalForm]],ExpressionUUID->
  "c344bf45-6ef5-4a79-8240-864137ba1788"],
 "  which leads to Watterson\[CloseCurlyQuote]s estimator of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "N"], TraditionalForm]],ExpressionUUID->
  "a4721676-855a-4c6d-b4a5-901267223f40"],
 "\ni.e. when there are J SNPs in the SFS, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Theta]", "^"], "N"], "=", 
    RowBox[{
     RowBox[{"4", "N", " ", 
      SubscriptBox["u", "N"]}], "=", 
     RowBox[{"J", "/", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"n", "-", "1"}]], 
       FractionBox["1", "i"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "edefd452-d2d3-4a35-b43c-c09525d71419"],
 "\nFor example,  when there are just 2 edges the expected total length is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", " ", "N"}], TraditionalForm]],ExpressionUUID->
  "44c36799-714d-4c42-84b7-596115b62121"],
 ", and when there are ",
 Cell[BoxData[
  FormBox["100", TraditionalForm]],ExpressionUUID->
  "4ff2fdfa-0df9-428b-938e-abcd53a47e68"],
 " edges it is ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"4", "N"}], "99"], TraditionalForm]],ExpressionUUID->
  "b9b9e8df-3fec-4758-8722-35be2039fd9e"],
 "\n(It is meaningless to consider the case of just 1 edge,  as no \
polymorphic sites could arise on that. )\n\nWith selection, using ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"i", ",", "\[Gamma]"}], "]"}], " "}], TraditionalForm]],
  ExpressionUUID->"a5a2f6a2-baaa-43e6-a4c8-da5a8ba0607b"],
 ",  presumably  we can think of the expected total length of the tree when \
there are ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "f779f909-9048-40fa-8ae3-600ed0a1a475"],
 " edges  as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", "N", " ", 
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"i", "-", "1"}], ",", "\[Gamma]"}], "]"}]}], TraditionalForm]],
  ExpressionUUID->"26da635b-acc1-4bec-b300-a6773b857d72"],
 "\n\nIf we are comparing neutral and selected SFSs,  then each will have \
their own \[Theta].  They will share demography, and thus ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "aefc9a89-7f3c-4930-ab10-bc245099d0a0"],
 ", but there will be a mutation rate for neutral and for selected.  \nLet ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "s"], TraditionalForm]],ExpressionUUID->
  "2d985f21-d54c-4c9b-be5e-66613133703d"],
 " be for selected sites.  Then the number of invariant sites due to \
selection is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], 
     RowBox[{"n", "-", "1"}]], 
    RowBox[{
     SubscriptBox["\[Theta]", "s"], "(", 
     RowBox[{
      FractionBox["1", "i"], "-", 
      RowBox[{"F", "[", 
       RowBox[{"i", ",", "\[Gamma]"}], "]"}]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"0a8b45f7-12c2-42c5-a01c-d948a0244d40"],
 " \nIf we want to use the singleton class to tell us about the ratio of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "s"], "/", 
    SubscriptBox["\[Theta]", "n"]}], TraditionalForm]],ExpressionUUID->
  "373c3c85-f1dd-4a28-9f1e-260540923135"],
 "  \nWithout selection we would have observed ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "s"], TraditionalForm]],ExpressionUUID->
  "9d7cf8fc-d617-46e9-9e5e-65eaa1a69f9b"],
 " selected singletons,  but we observed only ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "s"], 
    RowBox[{"F", "[", 
     RowBox[{"1", ",", "\[Gamma]"}], "]"}]}], TraditionalForm]],
  ExpressionUUID->"85a60195-cb59-43b3-8035-abf820c99117"],
 "  \nFor the neutral sites we observed ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "n"], TraditionalForm]],ExpressionUUID->
  "6dc329ff-adaa-4c70-9a08-b3ca560f43a5"],
 " singletons. \nSo if we observe ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "96ae31b8-56c4-4e34-8762-0baa54f5f00b"],
 " neutral singletons and ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "3109ff80-e483-4cd8-bb0b-7a920d94e4a9"],
 " selected,  then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Theta]", "s"], "/", 
     SubscriptBox["\[Theta]", "n"]}], "=", " ", 
    RowBox[{"X", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"1", ",", "\[Gamma]"}], "]"}], " ", "Y"}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"e339668b-00de-4181-b15d-295c10819b36"],
 "\n"
}], "Text",
 CellChangeTimes->{{3.900426706363456*^9, 3.900426746514601*^9}, {
  3.9004268727428513`*^9, 3.9004269801381097`*^9}, {3.900427025068348*^9, 
  3.900427060608634*^9}, {3.900427151600788*^9, 3.9004271974923716`*^9}, {
  3.900427233699589*^9, 3.9004274025852914`*^9}, {3.9004274588115807`*^9, 
  3.9004275036771493`*^9}, {3.9004275507285967`*^9, 3.90042763204986*^9}, {
  3.9004276777948036`*^9, 3.900427696434946*^9}, {3.900427802406867*^9, 
  3.9004278429035482`*^9}, {3.900427944426938*^9, 3.900427982444147*^9}, {
  3.9004280240464706`*^9, 3.9004282647451878`*^9}, {3.9017192775055475`*^9, 
  3.901719424377273*^9}},ExpressionUUID->"a2b1f92c-3ecf-434c-8ea4-\
9ecdcd706cad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Getting a relatively calculable form for  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"F", "(", 
    RowBox[{"i", ",", "\[Gamma]"}], ")"}], TraditionalForm]],ExpressionUUID->
  "c56e5b2f-9089-4487-8ea2-40127958a446"]
}], "Section",
 CellChangeTimes->{{3.8963430951525254`*^9, 3.8963430971368985`*^9}, {
  3.8963431280231857`*^9, 
  3.8963431593173156`*^9}},ExpressionUUID->"9410a3a4-2a13-4959-8537-\
5cfe6af67d29"],

Cell[TextData[{
 "Can we do the integration for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}], " "}], TraditionalForm]],
  ExpressionUUID->"86f6c22f-7816-4e8f-a841-314a7bf7600a"],
 ".  Yes but get a complicated function. \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{"q", ",", "\[Gamma]"}], ")"}], "=", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"\[Gamma]", "(", 
          RowBox[{"1", "-", "q"}], ")"}]}]]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], "\[Gamma]"}]]}], ")"}], 
      RowBox[{"q", "(", 
       RowBox[{"1", "-", "q"}], ")"}]}]]}], TraditionalForm]],ExpressionUUID->
  "ab6f699b-0ec3-4239-bf6b-fca06f4a945e"],
 "\nand F[n,i,\[Gamma]]= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "1"], 
     RowBox[{
      RowBox[{"f", "(", 
       RowBox[{"q", ",", "\[Gamma]"}], ")"}], " ", 
      RowBox[{"(", GridBox[{
         {"n"},
         {"i"}
        }], ")"}], 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["q", "i"], "(", 
        RowBox[{"1", "-", "q"}], ")"}], 
       RowBox[{"n", "-", "i"}]], " ", 
      RowBox[{"\[DifferentialD]", "q"}]}]}], "=", 
    FractionBox[
     RowBox[{"n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Coth", "[", "\[Gamma]", "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
         RowBox[{"Hypergeometric1F1", "[", 
          RowBox[{"i", ",", "n", ",", 
           RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}]}], ")"}]}], 
     RowBox[{"2", " ", "i", " ", 
      RowBox[{"(", 
       RowBox[{"n", "-", "i"}], ")"}]}]]}], TraditionalForm]],ExpressionUUID->
  "8a5afbd6-9b77-4043-91bc-2a601cd4191a"],
 "\nThe hypergeometric term is always positive.  The Coth term has the sign \
of \[Gamma],  and for \[Gamma]>10 or so returns 1,  and for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Gamma]", "<", "10"}], TraditionalForm]],ExpressionUUID->
  "9527bb6e-40ba-40e4-b78d-79de64029717"],
 " returns -1 . \n\nNonetheless the calculation of  F(i,\[Gamma])  yields  a \
number,  i.e. a constant for a given ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", ",", "\[Gamma]"}], TraditionalForm]],ExpressionUUID->
  "a8988d8b-2e5c-41c6-8e9e-f9d120a4aa46"],
 " and so ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["X", "i"], "=", 
       RowBox[{
        SubscriptBox["x", "i"], "|", "\[Theta]"}]}], ",", "\[Gamma]"}], ")"}],
     "=", 
    FractionBox[
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Theta]"}], " ", 
         RowBox[{"F", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "(", 
       RowBox[{"\[Theta]", " ", 
        RowBox[{"F", "(", 
         RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
      SubscriptBox["x", "i"]], 
     RowBox[{
      SubscriptBox["x", "i"], "!"}]]}], TraditionalForm]],ExpressionUUID->
  "4e7847bc-7b52-4b46-b8a6-71f5e8fea8d4"],
 " is a regular Poisson random variable.\n\n\nTwo work with the folded \
distribution we also need ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"n", ",", 
      RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], "]"}], "=", 
    FormBox[
     FractionBox[
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Coth", "[", "\[Gamma]", "]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
          RowBox[{"Hypergeometric1F1", "[", 
           RowBox[{
            RowBox[{"n", "-", "i"}], ",", "n", ",", 
            RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}]}], ")"}]}], 
      RowBox[{"2", " ", "i", " ", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]],
     TraditionalForm]}], TraditionalForm]],ExpressionUUID->
  "206dda2b-2e9f-4527-a547-e079eff3a342"],
 "\nWhen \[Gamma] is high, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Coth", "[", "\[Gamma]", "]"}], TraditionalForm]],ExpressionUUID->
  "6bc27c81-aab9-420d-94da-708d00f095e4"],
 " is 1, and each of these become ",
 Cell[BoxData[
  FormBox[
   FractionBox["n", 
    RowBox[{"i", "(", 
     RowBox[{"n", "-", "i"}], ")"}]], TraditionalForm]],ExpressionUUID->
  "bc25eb58-df4a-4cf3-898e-55579f35ead9"],
 "\nThe sum of these is ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"n", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"2", " ", 
        RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Hypergeometric1F1", "[", 
           RowBox[{"i", ",", "n", ",", 
            RowBox[{"2", " ", "\[Gamma]"}]}], "]"}], "+", 
          RowBox[{"Hypergeometric1F1", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "i"}], "+", "n"}], ",", "n", ",", 
            RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"2", " ", "i", " ", 
     RowBox[{"(", 
      RowBox[{"n", "-", "i"}], ")"}]}]], TraditionalForm]],ExpressionUUID->
  "371909f3-8958-4497-87be-5fd3e6a5d954"],
 "\nWhen \[Gamma] is high, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Coth", "[", "\[Gamma]", "]"}], TraditionalForm]],ExpressionUUID->
  "b50318d1-1295-4eeb-9931-63a5214a033d"],
 " is 1, and  this becomes ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"2", " ", "n"}], 
    RowBox[{"i", "(", 
     RowBox[{"n", "-", "i"}], ")"}]], TraditionalForm]],ExpressionUUID->
  "ed060aa8-abbb-4329-83de-d255135fcfe6"]
}], "Text",
 CellChangeTimes->{{3.6049658220203104`*^9, 3.604965827361318*^9}, {
   3.604966007712572*^9, 3.6049661162047243`*^9}, {3.6049661506777725`*^9, 
   3.6049661894338274`*^9}, {3.892820715257493*^9, 3.8928207521852713`*^9}, {
   3.892821222731608*^9, 3.892821271036702*^9}, {3.8928213442047186`*^9, 
   3.892821398220025*^9}, {3.8928214702292795`*^9, 3.892821593649423*^9}, {
   3.892821633090165*^9, 3.892821648590603*^9}, {3.8928216987031107`*^9, 
   3.892821816927553*^9}, {3.892821978148059*^9, 3.892822005547213*^9}, 
   3.892822036496767*^9, {3.8928220950417414`*^9, 3.89282214344637*^9}, {
   3.892822197938811*^9, 3.892822212021909*^9}, {3.892823183941673*^9, 
   3.8928234891118174`*^9}, {3.8928235769206123`*^9, 
   3.8928235810486565`*^9}, {3.894124835043976*^9, 3.8941249937403145`*^9}, 
   3.8941252239453163`*^9, 3.895731922930401*^9, {3.8957352636826105`*^9, 
   3.8957352815131316`*^9}, {3.8957353131586804`*^9, 
   3.8957353142928877`*^9}, {3.8957365072665787`*^9, 
   3.8957365752835984`*^9}, {3.8963431812338867`*^9, 
   3.8963431969143305`*^9}, {3.896343289955268*^9, 3.896343329750311*^9}, {
   3.89634342957594*^9, 3.8963434336376057`*^9}, {3.900768324780671*^9, 
   3.9007683850302672`*^9}, {3.9007684152252274`*^9, 
   3.9007684401990986`*^9}, {3.9008292881638927`*^9, 
   3.9008294005297565`*^9}, {3.900830990821481*^9, 3.900831036196802*^9}, {
   3.9008311126417184`*^9, 3.900831113158383*^9}, {3.901730358400196*^9, 
   3.9017303647512836`*^9}, {3.9017307818646317`*^9, 
   3.9017308796184745`*^9}, {3.9017312773181705`*^9, 
   3.9017313068765306`*^9}, {3.9017313424245524`*^9, 
   3.9017313426095123`*^9}, {3.901731410051182*^9, 3.901731415174051*^9}, {
   3.9017317324468765`*^9, 3.9017317416361685`*^9}, {3.901731855848358*^9, 
   3.901731855848358*^9}, {3.901731923329621*^9, 3.901731969872546*^9}, {
   3.901804926221922*^9, 3.9018049313949456`*^9}, {3.901805111992536*^9, 
   3.9018051374769*^9}},ExpressionUUID->"8a37da2e-6fd7-402c-9674-\
73c520689e7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"q_", ",", "\[Gamma]_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], 
        RowBox[{"\[Gamma]", "(", 
         RowBox[{"1", "-", "q"}], ")"}]}]]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], "\[Gamma]"}]]}], ")"}], 
     RowBox[{"q", "(", 
      RowBox[{"1", "-", "q"}], ")"}]}]]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.895735321383156*^9, 3.8957353517170706`*^9}, {
   3.8957354021984367`*^9, 3.8957354846975794`*^9}, {3.8957355448856945`*^9, 
   3.8957355654233255`*^9}, {3.895735604006863*^9, 3.8957356252158833`*^9}, {
   3.895735671402816*^9, 3.8957356956921835`*^9}, {3.896343710417497*^9, 
   3.8963437242148523`*^9}, 3.900829421849828*^9},
 CellLabel->
  "In[483]:=",ExpressionUUID->"7ab11f54-aa9c-4684-a149-7f97c1c1fc87"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "i", " ", 
    RowBox[{"(", 
     RowBox[{"i", "-", "n"}], ")"}]}]], 
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Hypergeometric1F1", "[", 
         RowBox[{"i", ",", "n", ",", 
          RowBox[{"2", " ", "\[Gamma]"}]}], "]"}], "+", 
        RowBox[{"Hypergeometric1F1", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "i"}], "+", "n"}], ",", "n", ",", 
          RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9008310544773965`*^9, 3.900831098378644*^9}, {
  3.900831242079687*^9, 3.900831246131778*^9}, {3.9008312830311327`*^9, 
  3.9008312908841677`*^9}},ExpressionUUID->"49fcb4c3-da92-491a-893a-\
1f2d77d21841"],

Cell[BoxData[
 RowBox[{"Integrate", " ", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"q", ",", "\[Gamma]"}], "]"}], " ", 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"BinomialDistribution", "[", 
       RowBox[{"n", ",", "q"}], "]"}], ",", "i"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", ">", "0"}], ",", 
      RowBox[{"i", "<", "n"}], ",", 
      RowBox[{"i", "\[Element]", "Integers"}], ",", 
      RowBox[{"n", " ", "\[Element]", " ", "Integers"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8959235999984837`*^9, 3.8959236091834345`*^9}, {
  3.8963437314335175`*^9, 3.896343731881586*^9}, {3.900829409780924*^9, 
  3.9008294103385763`*^9}},
 CellLabel->
  "In[484]:=",ExpressionUUID->"157770f8-2286-49a2-9490-a3c89ba8855a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "i", " ", 
    RowBox[{"(", 
     RowBox[{"i", "-", "n"}], ")"}]}]], 
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"Coth", "[", "\[Gamma]", "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
      RowBox[{"Hypergeometric1F1", "[", 
       RowBox[{"i", ",", "n", ",", 
        RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.900829450102085*^9, 
  3.9008294502779045`*^9}},ExpressionUUID->"965c4e6f-c08e-4d86-af4d-\
81670133e531"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"n_", ",", "i_", ",", "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     FractionBox["1", 
      RowBox[{"2", " ", "i", " ", 
       RowBox[{"(", 
        RowBox[{"i", "-", "n"}], ")"}]}]], ")"}], "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"Coth", "[", "\[Gamma]", "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
       RowBox[{"Hypergeometric1F1", "[", 
        RowBox[{"i", ",", "n", ",", 
         RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8957357186739187`*^9, 3.8957357787804527`*^9}, {
   3.8957360393141932`*^9, 3.8957361808168087`*^9}, {3.895736237154887*^9, 
   3.895736270640266*^9}, {3.8957363649377003`*^9, 3.8957364590153112`*^9}, {
   3.895744105406527*^9, 3.895744161421191*^9}, 3.895762061524955*^9, 
   3.8958482803280725`*^9, {3.8959232959072237`*^9, 3.895923304463549*^9}, {
   3.896343221043412*^9, 3.8963432219236584`*^9}, 3.901708193308955*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"3ab9c7c1-261f-4577-a22c-b019fbc13b44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"n", ",", "i", ",", "\[Gamma]"}], "]"}], "+", 
  RowBox[{"F", "[", 
   RowBox[{"n", ",", 
    RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.90051316439546*^9, 3.900513208326668*^9}},
 CellLabel->
  "In[465]:=",ExpressionUUID->"1713956b-1656-4069-bfd1-8a2a5b28f841"],

Cell[BoxData[
 FractionBox[
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Hypergeometric1F1", "[", 
         RowBox[{"i", ",", "n", ",", 
          RowBox[{"2", " ", "\[Gamma]"}]}], "]"}], "+", 
        RowBox[{"Hypergeometric1F1", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "i"}], "+", "n"}], ",", "n", ",", 
          RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"2", " ", "i", " ", 
   RowBox[{"(", 
    RowBox[{"i", "-", "n"}], ")"}]}]]], "Input",
 CellChangeTimes->{{3.900513214875797*^9, 
  3.900513215225713*^9}},ExpressionUUID->"bb05cacb-f224-4a65-98f3-\
5fc5d277baf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"n", ",", "i", ",", "\[Gamma]"}], "]"}], ",", 
   RowBox[{"\[Gamma]", "->", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8959244940467124`*^9, 3.895924500348426*^9}, {
   3.896343340341337*^9, 3.896343357252575*^9}, 3.8963433949346437`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"4c65a1a8-d735-40c6-a4bf-cd34bde596cf"],

Cell[BoxData[
 FractionBox["1", "i"]], "Output",
 CellChangeTimes->{3.8959245017708416`*^9, 3.896343349958358*^9, 
  3.8963434003641167`*^9, 3.8963437491921496`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"8458d4e7-1558-4ede-95b8-e77c3e1ae04b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"n", ",", 
     RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], "]"}], ",", 
   RowBox[{"\[Gamma]", "->", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8958479151338797`*^9, 3.895847933022399*^9}, {
  3.8958479688134217`*^9, 3.895847969403861*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"7bb9251e-3376-49c9-80d7-907a6f4b49db"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   RowBox[{"-", "i"}], "+", "n"}]]], "Output",
 CellChangeTimes->{3.8958479346691504`*^9, 3.895847970657852*^9, 
  3.8963438367742815`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"1370e65d-ff34-4498-8207-091718cc9195"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895851843413002*^9, 
  3.895851846061078*^9}},ExpressionUUID->"db9600c2-a87a-4f17-a860-\
6735de916bf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating probabilities for SFS data", "Section",
 CellChangeTimes->{{3.8957370104890604`*^9, 3.895737011552427*^9}, {
  3.896353824336341*^9, 
  3.8963538441434946`*^9}},ExpressionUUID->"e494b141-e148-4766-8f52-\
41193e1dc916"],

Cell[TextData[{
 "For a set of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "2bf5c27c-ab35-4636-adcd-6134ba204bec"],
 " genomes, the SFS is a set of observations, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["X", "0"], ",", 
      SubscriptBox["X", "1"], ",", " ", "...", ",", 
      SubscriptBox["X", "n"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "779e54fa-fcb8-4809-8c24-c77567e7aeea"],
 " where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "i"], TraditionalForm]],ExpressionUUID->
  "83bebea9-3182-4ae4-9fce-fee7a510602c"],
 " is the number of SNPs with ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "849cd41b-add1-4e3d-88de-580b493c2e47"],
 " derived copies. \nIf we are talking just polymorphic sites,  then ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["X", "1"], ",", " ", "...", ",", 
      RowBox[{
       SubscriptBox["X", "n"], "-", "1"}]}], "}"}], " "}], TraditionalForm]],
  ExpressionUUID->"972b73e0-86de-4555-a402-e9354b80bc1f"],
 "\nThe probability of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "  "}], TraditionalForm]],ExpressionUUID->
  "d953e737-8ac4-4a76-8f84-212781f56921"],
 "is given above: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{
      RowBox[{"X", "|", "\[Theta]"}], ",", "\[Gamma]"}], ")"}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "-", "1"}]], 
     FractionBox[
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[Theta]"}], " ", 
          RowBox[{"F", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "(", 
        RowBox[{"\[Theta]", " ", 
         RowBox[{"F", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
       SubscriptBox["x", "i"]], 
      RowBox[{
       SubscriptBox["x", "i"], "!"}]]}]}], TraditionalForm]],ExpressionUUID->
  "02578bdf-3bd4-4173-935d-f5e180e643b1"]
}], "Text",
 CellChangeTimes->{{3.895737020600732*^9, 3.8957371894523196`*^9}, {
   3.8957372398480873`*^9, 3.895737448682968*^9}, {3.895737509274415*^9, 
   3.895737514050961*^9}, {3.895737560898309*^9, 3.895737602607317*^9}, {
   3.8957376408215094`*^9, 3.8957376697395234`*^9}, {3.8957377103836427`*^9, 
   3.8957377641232014`*^9}, {3.895738624214015*^9, 3.895738724355429*^9}, {
   3.8957624712842093`*^9, 3.8957624726640787`*^9}, {3.8958480108174005`*^9, 
   3.8958480594617004`*^9}, {3.895848104148905*^9, 3.8958481494127173`*^9}, {
   3.8959101252441134`*^9, 3.8959101643010535`*^9}, {3.900417272958336*^9, 
   3.9004172842698936`*^9}, {3.900418033827054*^9, 3.900418037042161*^9}, 
   3.9004286421612597`*^9},ExpressionUUID->"e188632e-187c-4983-b8d4-\
3aae70a6949a"],

Cell[CellGroupData[{

Cell["For the folded distribution", "Subsubsection",
 CellChangeTimes->{{3.900428647040537*^9, 
  3.9004286504806404`*^9}},ExpressionUUID->"39c73e3d-6ac7-4dd0-8d57-\
58a30d24d272"],

Cell[TextData[{
 "If we are considering the folded distribution,  define ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["X", "i"], "\[Prime]"], "=", 
    RowBox[{
     SubscriptBox["X", "i"], "+", 
     SubscriptBox["X", 
      RowBox[{"n", "-", "i"}]]}]}], TraditionalForm]],ExpressionUUID->
  "68b07997-f349-450c-bc73-50b1e881a520"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "<", 
    RowBox[{"n", "-", "i"}]}], TraditionalForm]],ExpressionUUID->
  "b0d3c5cb-5274-48df-8b18-7c6be284627f"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["X", 
      RowBox[{"n", "/", "2"}]], "\[Prime]"], "=", 
    SubscriptBox["X", 
     RowBox[{"n", "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "a9bab88f-433a-4247-b3ce-794684113fbb"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", " ", "=", " ", 
    RowBox[{"n", "/", "2"}]}], TraditionalForm]],ExpressionUUID->
  "72fcc553-e778-43d0-9c5e-b6f29482544d"],
 " (if ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "aa36c43b-4a8a-4261-b928-efb66f6d543d"],
 " is even) \nSo we need a convolution \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["X", "i"], "\[Prime]"], "=", "z"}], ")"}], " ", "=", " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"k", "=", "0"}], "z"], 
     RowBox[{
      RowBox[{"P", "(", 
       RowBox[{
        SubscriptBox["X", "i"], "=", "k"}], ")"}], 
      RowBox[{"P", "(", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"n", "-", "i"}]], "=", 
        RowBox[{"z", "-", "k"}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"8deb5d7b-05f0-4540-a6d5-bbda67d02270"],
 "\nLet ",
 Cell[BoxData[
  FormBox["Fi", TraditionalForm]],ExpressionUUID->
  "aa0f95fd-31fc-44c9-ad74-6c2a879e7df6"],
 " be ",
 Cell[BoxData[
  FormBox[
   RowBox[{"F", "(", 
    RowBox[{"i", ",", "\[Gamma]"}], ")"}], TraditionalForm]],ExpressionUUID->
  "012019e9-3cd5-4ccf-ab9d-d686dd3465c6"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Fni", "=", 
    RowBox[{"F", "(", 
     RowBox[{
      RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"cc790b13-636f-4736-81f4-1cf1f92d9649"],
 "\nThen the convolution is equal to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["X", "i"], "\[Prime]"], "=", "z"}], ")"}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", " ", 
        RowBox[{"\[Theta]", "(", 
         RowBox[{"Fi", "+", "Fnmi"}], ")"}]}]], "  ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]", "Z"], "(", 
        RowBox[{"Fi", "+", "Fni"}], ")"}], "z"]}], 
     RowBox[{"z", "!"}]]}], TraditionalForm]],ExpressionUUID->
  "63cd3014-ddc8-4eca-af46-5af97d39090f"],
 ".  i.e. the probability distribution is a Poisson distribution with a rate \
that is the sum of the two rates from the unfolded distribution. \nIn the \
neutral case ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}], "=", 
    FractionBox["1", "i"]}], TraditionalForm]],ExpressionUUID->
  "9d51a969-cb37-4417-ab51-87ffa0d73f06"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "(", 
     RowBox[{
      RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}], "=", 
    FractionBox["1", 
     RowBox[{"n", "-", "i"}]]}], TraditionalForm]],ExpressionUUID->
  "a9114438-3ef2-4742-a8e1-98e4f6a070d6"],
 ", they sum is ",
 Cell[BoxData[
  FormBox[
   FractionBox["n", 
    RowBox[{"i", " ", 
     RowBox[{"(", 
      RowBox[{"n", "-", "i"}], ")"}]}]], TraditionalForm]],ExpressionUUID->
  "88d2435c-5787-4a85-bcc4-93dc58c2df62"],
 ", so ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["X", "i"], "\[Prime]"], "=", 
      SubscriptBox["x", "i"]}], ")"}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", " ", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"\[Theta]", " ", "n"}], 
          RowBox[{"i", " ", 
           RowBox[{"(", 
            RowBox[{"n", "-", "i"}], ")"}]}]], ")"}]}]], "  ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Theta]", " ", "n"}], 
         RowBox[{"i", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "i"}], ")"}]}]], ")"}], 
       SubscriptBox["x", "i"]]}], 
     RowBox[{
      SubscriptBox["x", "i"], "!"}]]}], TraditionalForm]],ExpressionUUID->
  "c7d87fa4-1cf9-4e19-993a-6679af4b2991"]
}], "Text",
 CellChangeTimes->{{3.895737020600732*^9, 3.8957371894523196`*^9}, {
  3.8957372398480873`*^9, 3.895737448682968*^9}, {3.895737509274415*^9, 
  3.895737514050961*^9}, {3.895737560898309*^9, 3.895737602607317*^9}, {
  3.8957376408215094`*^9, 3.8957376697395234`*^9}, {3.8957377103836427`*^9, 
  3.8957377641232014`*^9}, {3.895738624214015*^9, 3.895738724355429*^9}, {
  3.8957624712842093`*^9, 3.8957624726640787`*^9}, {3.8958480108174005`*^9, 
  3.8958480594617004`*^9}, {3.895848104148905*^9, 3.8958481494127173`*^9}, {
  3.8959101252441134`*^9, 3.8959101643010535`*^9}, {3.900417272958336*^9, 
  3.9004172842698936`*^9}, {3.900418033827054*^9, 
  3.900418037042161*^9}},ExpressionUUID->"c636324b-d3f2-4fe8-8ea3-\
8cce312f6e6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unfolded with rooting error", "Subsubsection",
 CellChangeTimes->{{3.9004286679051676`*^9, 
  3.900428671314266*^9}},ExpressionUUID->"6dfce641-f216-4742-8404-\
86839e71f016"],

Cell[TextData[{
 "Suppose we work with an unfolded distribution but include a probability of \
failed rooting \nSee Williamson et al below who specify a parameter for \
correctly identifying ancestral allele ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Pr", "(", 
    RowBox[{"m", "=", "a"}], ")"}], TraditionalForm]],ExpressionUUID->
  "55860b0a-f22a-439c-a2b9-7dfa088e08ec"],
 "\nlet ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Omega]", "=", 
    RowBox[{"1", "-", 
     RowBox[{"Pr", "(", 
      RowBox[{"m", "=", "a"}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "0c3d9e02-42ba-4111-824f-7103988bb601"],
 " ,  the misspecification probability,  which we will suppose is much less \
than 0.5. \n \nNow suppose we have an unfolded distribution,  but the \
observed value of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "i"], TraditionalForm]],ExpressionUUID->
  "aece6c74-b162-4801-b7bd-b8f117080cad"],
 " includes some correctly identified SNPs and some that should be in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", 
    RowBox[{"n", "-", "i"}]], TraditionalForm]],ExpressionUUID->
  "6e16698f-9476-44a1-b72c-6a5809f2ec06"],
 " because they were misidentified.  Similarly ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", 
    RowBox[{"n", "-", "i"}]], TraditionalForm]],ExpressionUUID->
  "ec1b1174-c506-4949-8ddb-60a3a6758991"],
 " has some that should be in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "i"], TraditionalForm]],ExpressionUUID->
  "10bdc8e5-b87e-473d-88aa-e448acc0125f"],
 "\nThen ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["X", "i"], "\[Prime]"], "=", 
      SubscriptBox["x", "i"]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"j", "=", "0"}], 
       SubscriptBox["x", "i"]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Omega]"}], ")"}], 
        RowBox[{
         SubscriptBox["x", "i"], "-", "j"}]], 
       FractionBox[
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]"}], " ", 
            RowBox[{"F", "(", 
             RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "(", 
          RowBox[{"\[Theta]", " ", 
           RowBox[{"F", "(", 
            RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "i"], "-", "j"}], ")"}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "i"], "-", "j"}], ")"}], "!"}]], 
       SuperscriptBox["\[Omega]", 
        RowBox[{" ", "j"}]], 
       FractionBox[
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]"}], " ", 
            RowBox[{"F", "(", 
             RowBox[{
              RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}]}]], "(", 
          RowBox[{"\[Theta]", " ", 
           RowBox[{"F", "(", 
            RowBox[{
             RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}]}], ")"}], 
         RowBox[{" ", "j"}]], 
        RowBox[{"j", " ", "!"}]]}]}], "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"F", "(", 
              RowBox[{"i", ",", "\[Gamma]"}], ")"}], "+", 
             RowBox[{"F", "(", 
              RowBox[{
               RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}]}], ")"}], 
           " ", "\[Theta]"}], ")"}]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Theta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"F", "(", 
              RowBox[{"i", ",", "\[Gamma]"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Omega]"}], ")"}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"F", "(", 
              RowBox[{
               RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}], 
             "\[Omega]"}]}], ")"}]}], ")"}], "x"]}], 
      RowBox[{"x", "!"}]]}]}], TraditionalForm]],ExpressionUUID->
  "e6227981-30d6-4628-af2e-3013e2d0e750"],
 "\nThis seems tractable as the log of this is just\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"F", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}], "+", 
         RowBox[{"F", "(", 
          RowBox[{
           RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}]}], ")"}], " ", 
       "\[Theta]"}], ")"}]}], " ", "+", " ", 
    RowBox[{"x", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"\[Theta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"F", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Omega]"}], ")"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"F", "(", 
           RowBox[{
            RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}], "\[Omega]"}]}],
         ")"}]}], "]"}]}], " ", "-", " ", 
    RowBox[{"Loggamma", "[", "x", "]"}]}], TraditionalForm]],ExpressionUUID->
  "e40b9adb-c516-409a-97ef-68d27bc60a92"],
 " \n\n"
}], "Text",
 CellChangeTimes->{{3.900416795524253*^9, 3.900416827364976*^9}, {
  3.9004169566951227`*^9, 3.900417113723482*^9}, {3.9004172670333805`*^9, 
  3.900417413374888*^9}, {3.900417457550294*^9, 3.9004175580134506`*^9}, {
  3.9004175941110744`*^9, 3.9004176260971875`*^9}, {3.9004176984646616`*^9, 
  3.9004177033133755`*^9}, {3.900417984703941*^9, 3.900417986111977*^9}, {
  3.9004181010250826`*^9, 3.9004181323699245`*^9}, {3.900418317199664*^9, 
  3.9004184227523823`*^9}},ExpressionUUID->"0386f70f-53d9-4010-a972-\
f6fca4dc31f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "folded", " ", "distribution", " ", "with", " ", "selection", " ", "is", 
     " ", "F", 
     RowBox[{"(", 
      RowBox[{"n", ",", "i", ",", "\[Gamma]"}], ")"}]}], "+", 
    RowBox[{"F", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", "-", "i"}], ",", "i", ",", "\[Gamma]"}], ")"}]}]}], 
   "*)"}], 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"n", ",", "i", ",", "\[Gamma]"}], "]"}], "+", 
   RowBox[{"F", "[", 
    RowBox[{"n", ",", 
     RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8963437696772027`*^9, 3.8963438080268283`*^9}, {
  3.8963451246049366`*^9, 
  3.8963451262680182`*^9}},ExpressionUUID->"1a6654f6-e430-40bc-af29-\
897d29cb94a6"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"Coth", "[", "\[Gamma]", "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
       RowBox[{"Hypergeometric1F1", "[", 
        RowBox[{"i", ",", "n", ",", 
         RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", "i", " ", 
    RowBox[{"(", 
     RowBox[{"i", "-", "n"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"Coth", "[", "\[Gamma]", "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
       RowBox[{"Hypergeometric1F1", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "i"}], "+", "n"}], ",", "n", ",", 
         RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", "i", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "i"}], "+", "n"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.8963438091746235`*^9, 3.8963451095767584`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"3dbd2910-9600-431b-83ae-5f871a338850"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solving for the distribution of fitness effects (i.e. the DFE)\
\>", "Section",
 CellChangeTimes->{{3.898961734714754*^9, 
  3.8989617703385983`*^9}},ExpressionUUID->"1a6bb85e-a3b8-497a-99b9-\
a6510d3e7610"],

Cell["\<\
Is it possible to resolve the DFE?  
Some literature on this:
\
\>", "Text",
 CellChangeTimes->{{3.8989617744533324`*^9, 3.898961779907942*^9}, {
   3.8989618186227207`*^9, 3.8989618599677706`*^9}, {3.8989619163726034`*^9, 
   3.8989619250101147`*^9}, {3.898961960090625*^9, 3.8989620049892025`*^9}, {
   3.898962044254939*^9, 3.8989620911647077`*^9}, {3.8989621219142265`*^9, 
   3.8989622986837626`*^9}, {3.8989623540876684`*^9, 
   3.8989623813476653`*^9}, {3.8989624481627035`*^9, 
   3.8989625653342805`*^9}, {3.898962636769024*^9, 3.8989626503271184`*^9}, {
   3.898962854376378*^9, 3.8989628696550145`*^9}, {3.8989629210795116`*^9, 
   3.89896297769839*^9}, 3.899891123048034*^9, {3.899968562138077*^9, 
   3.8999685627136087`*^9}, 3.900400997528341*^9, {3.9004197346993895`*^9, 
   3.900419735533659*^9}},ExpressionUUID->"6c1034d2-c185-427a-845a-\
ff2e699ca530"],

Cell[CellGroupData[{

Cell["\<\
Williamson, S. H., et al. (2005). \[OpenCurlyDoubleQuote]Simultaneous \
inference of selection and population growth from patterns of variation in \
the human genome.\[CloseCurlyDoubleQuote] Proceedings of the National Academy \
of Sciences 102(22): 7882-7887.\
\>", "Subsubsection",
 CellChangeTimes->{
  3.9004035514336843`*^9},ExpressionUUID->"9137cd80-2c91-4bbf-8e7b-\
214f948aacee"],

Cell[TextData[{
 "Go through the basic PRF rationale,  but for a model of changing population \
size.  Develop the math for neutral and selected variants.    Define \
functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["F", "1"], "(", 
    RowBox[{"n", ",", "i", ",", ".."}], ")"}], TraditionalForm]],
  ExpressionUUID->"6827eed4-4df3-4abf-92d5-de5c6183d9b8"],
 "  (neutral) and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["F", "2"], "(", 
    RowBox[{"n", ",", "i", ",", "\[Gamma]", ",", "..."}], ")"}], 
   TraditionalForm]],ExpressionUUID->"2feac9df-6c61-4d58-a8fa-d836959d78d0"],
 " (Selected)  that are the expected proportions of SNPs that fall in class ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "1db480d3-09bc-4658-b6c7-52bbda4441bd"],
 "  .  These include the full spectrum for ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "8cfa40cf-b4b5-40ed-a732-c2fa13909dd1"],
 ", including 0 and ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "71fe8b01-67a6-464b-a1c8-74f7813f5e7f"],
 ".   They also define probabilities of observing a segregating SNP in class ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "d02a59a2-2232-44ed-aeeb-7e637b014333"],
 ",  i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["P", "1"], "(", 
     RowBox[{"n", ",", "i", ",", "..."}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", "1"], "(", 
      RowBox[{"n", ",", "i", ",", "..."}], ")"}], "/", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], 
       RowBox[{"n", "-", "1"}]], 
      RowBox[{
       SubscriptBox["F", "1"], "(", 
       RowBox[{"n", ",", "i", ",", "..."}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"41cb2025-cb70-41e8-8012-26a542c1ce56"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["P", "2"], "(", 
     RowBox[{"n", ",", "i", ",", "\[Gamma]", ",", "..."}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", "2"], "(", 
      RowBox[{"n", ",", "i", ",", "\[Gamma]", ",", "..."}], ")"}], "/", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], 
       RowBox[{"n", "-", "1"}]], 
      RowBox[{
       SubscriptBox["F", "2"], "(", 
       RowBox[{"n", ",", "i", ",", "\[Gamma]", ",", "..."}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"5f6f432d-8550-41e0-ae3e-79ed4a7a55a8"],
 "\n\nDescribe a way to handle ancestral allele misspecification.  \nLet \
there be two alleles at a SNP,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"a", " ", "and", " ", "b"}], TraditionalForm]],ExpressionUUID->
  "4647cd37-2b2a-44ea-a35a-97c4bc39d95d"],
 "\nlet ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "7eb03465-97fc-49f7-b8c2-0b9d7aac1088"],
 " be the true ancestral state and let ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Pr", "(", 
    RowBox[{"m", "=", "a"}], ")"}], TraditionalForm]],ExpressionUUID->
  "3740c2f4-b02c-4509-a518-b4132d31351e"],
 "  be the probabilities that the ancestor is allele state ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "8b5b561e-9a2d-430a-a9e4-84748affebb5"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"Pr", "(", 
     RowBox[{"m", "=", "a"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "2b12246e-6b78-4ffa-8f5d-652467d18035"],
 " be the probability it is ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "72e7d1e5-7e08-480f-aa29-04f5e752b604"],
 " .\n",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "65acbf97-a2a0-4e3b-9836-b7d1842d4714"],
 " is the number observed to have ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "31140389-cf33-470f-9c04-93bd3fd94280"],
 "  out of a sample of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "2f3b53fe-fb69-4453-ac80-8f9a772cc179"],
 "  \nThen at a particular neutral SNP,   the probability of observing ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "d278334b-063c-4bae-9897-1ec26a211d9d"],
 " ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],ExpressionUUID->
  "6fb33279-e56e-45c2-b13f-c28ad7240971"],
 " alleles is \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"Pr", "(", 
      RowBox[{"m", "=", "a"}], ")"}], 
     RowBox[{
      SubscriptBox["P", "1"], "(", 
      RowBox[{"n", ",", "i", ",", "..."}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Pr", "(", 
        RowBox[{"m", "=", "a"}], ")"}]}], ")"}], 
     RowBox[{
      SubscriptBox["P", "1"], "(", 
      RowBox[{"n", ",", 
       RowBox[{"n", "-", "i"}], ",", "..."}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"fa230de9-dca2-41a9-902f-4ed5b48ad375"],
 " \nAnd the likelihood of a data set is a product over all the SNPs \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "(", ")"}], "=", 
    RowBox[{
     RowBox[{
      UnderscriptBox["\[Product]", "k"], 
      RowBox[{
       RowBox[{"Pr", "(", 
        RowBox[{"m", "=", "a"}], ")"}], 
       RowBox[{
        SubscriptBox["P", "1"], "(", 
        RowBox[{"n", ",", 
         SubscriptBox["i", "k"], ",", "..."}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Pr", "(", 
         RowBox[{"m", "=", "a"}], ")"}]}], ")"}], 
      RowBox[{
       SubscriptBox["P", "1"], "(", 
       RowBox[{"n", ",", 
        RowBox[{"n", "-", 
         SubscriptBox["i", "k"]}], ",", "..."}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"a5f450ba-1583-47bb-91dc-0aadaae27467"],
 "\n\nThe  same idea applies for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "2"], TraditionalForm]],ExpressionUUID->
  "48f6b29c-646b-41b9-87af-46afff99dad7"],
 ".\n\nThis seems feasible,  see above "
}], "Text",
 CellChangeTimes->{{3.900404253107572*^9, 3.900404276868064*^9}, {
   3.900404317603568*^9, 3.900404321541174*^9}, {3.900404549898051*^9, 
   3.900404579608523*^9}, {3.900404615016807*^9, 3.9004047289549894`*^9}, {
   3.900404779339469*^9, 3.900404935632758*^9}, {3.900405014863516*^9, 
   3.900405016750929*^9}, {3.9004051624010253`*^9, 3.9004052760666485`*^9}, {
   3.900405310292133*^9, 3.900405624327566*^9}, {3.9004190850960484`*^9, 
   3.900419095206408*^9}, 
   3.9004196960283856`*^9},ExpressionUUID->"14fcdef3-bb70-4a64-b970-\
655bab0c9b1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Boyko, A. R., et al. (2008). \[OpenCurlyDoubleQuote]Assessing the \
evolutionary impact of amino acid mutations in the human genome.\
\[CloseCurlyDoubleQuote] PLoS Genet 4(5): e1000083.\
\>", "Subsubsection",
 CellChangeTimes->{
  3.900401008064801*^9},ExpressionUUID->"75eae659-5ab8-4774-a978-\
00867612c111"],

Cell[TextData[{
 "Used unfolded distribution, \nUsed Williamson et al (2005) on synonymous \
SFS to get the demography.\nUsed a method similar to what Williamson et al \
(2005) used to  handle errors in rooting. \nBasic math for bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "594a5372-e11f-46dc-8fe4-2bd3ee70cf49"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"E", "(", 
     SubscriptBox["X", "i"], ")"}], "=", 
    RowBox[{
     FractionBox["\[Theta]", "2"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "1"], 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"n"},
           {"i"}
          }], ")"}], 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["x", "i"], "(", 
          RowBox[{"1", "-", "x"}], ")"}], 
         RowBox[{"n", "-", "i"}]], 
        RowBox[{"f", "(", 
         RowBox[{
          RowBox[{"x", ";", "\[CapitalTheta]"}], ",", "\[Gamma]"}], ")"}], 
        RowBox[{"g", "(", "\[Gamma]", ")"}], 
        RowBox[{"\[DifferentialD]", "x"}], 
        RowBox[{"\[DifferentialD]", "\[Gamma]"}]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "805f8cc6-f82e-4e6b-b551-336c15e4d2ba"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "(", "\[Gamma]", ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "60f28f0d-32e5-4a59-bc73-644a69ecfc84"],
 " is the distribution of selection coefficients among new mutations\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{
      RowBox[{"x", ";", "\[CapitalTheta]"}], ",", "\[Gamma]"}], ")"}], " "}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "285570e0-5033-47e4-800a-11f9e011beed"],
 "is the distribution of mutation frequencies given selection (",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Gamma]", "=", 
    RowBox[{"2", "N", " ", "s"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3b740e38-7194-4874-9e8f-db2f8971cf7a"],
 ") and demography (\[CapitalTheta])\nThey applied this to a whole bunch of \
models,  including some in which there are point masses for density at \
\[Gamma]=0 and \[Gamma]=-\[Infinity]\n\nBut how could they estimate \
parameters for a density that includes terms that contribute nothing to the \
SFS  (i.e. when ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Gamma]", "=", 
    RowBox[{"-", "\[Infinity]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bbd67641-d21a-4385-ba76-d4a0f8a0bf7c"],
 ").  It turns out that they don\[CloseCurlyQuote]t estimate the selected and \
neutral values for \[Theta] at the same time. \n\[OpenCurlyDoubleQuote]The \
synonymous mutation rate (\[Theta]S) was calculated from the number of \
synonymous segregating sites by the method of Williamson et al. [19]; the \
nonsynonymous mutation rate (\[Theta]N) was fixed as 2.5 \[Times] \[Theta]S \
[45].\[CloseCurlyDoubleQuote]   \nWilliamson estimated ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "e"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8cf639dd-6a00-45c5-9d50-500bbd9e0d30"],
 " by fitting a demographic model.  But the 2.5 factor is worrisome.   It is \
this term that ends up spelling out how many \[OpenCurlyQuote]mutations\
\[CloseCurlyQuote] there are in the 0 class,  which are not observed, and yet \
which drive the conclusion that the best model includes a large fixed mass at \
\[Gamma]=-\[Infinity]. "
}], "Text",
 CellChangeTimes->{{3.9004010165406713`*^9, 3.9004010692296643`*^9}, {
  3.9004011260939293`*^9, 3.9004011334388723`*^9}, {3.9004011954557295`*^9, 
  3.9004012275692444`*^9}, {3.900402984015499*^9, 3.900403070163895*^9}, {
  3.9004031097328815`*^9, 3.900403131412925*^9}, {3.900403354520539*^9, 
  3.9004034533995686`*^9}, {3.900419104264084*^9, 3.900419312425107*^9}, {
  3.900419541082589*^9, 3.9004196453228846`*^9}, {3.9004197769103203`*^9, 
  3.9004197787164817`*^9}, {3.9004198122690372`*^9, 
  3.900419812621241*^9}},ExpressionUUID->"449ebba4-68b4-4465-85ae-\
af0b363407a8"],

Cell[TextData[{
 "Can we do the integration for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}], " "}], TraditionalForm]],
  ExpressionUUID->"9490ef60-d8fc-48cc-976e-fd1ce178a786"],
 ".  Yes but get a complicated function. \nNonetheless the calculation of  \
F(i,\[Gamma])  yields  a number,  i.e. a constant,  and so ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["X", "i"], "=", 
       RowBox[{
        SubscriptBox["x", "i"], "|", "\[Theta]"}]}], ",", "\[Gamma]"}], ")"}],
     "=", 
    FractionBox[
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Theta]"}], " ", 
         RowBox[{"F", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "(", 
       RowBox[{"\[Theta]", " ", 
        RowBox[{"F", "(", 
         RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
      SubscriptBox["x", "i"]], 
     RowBox[{
      SubscriptBox["x", "i"], "!"}]]}], TraditionalForm]],ExpressionUUID->
  "a7eeeff9-ad93-4c1e-9130-97bc94a87aa3"],
 " is a regular Poisson random variable.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"n", ",", "i", ",", "\[Gamma]"}], "]"}], "=", 
    FractionBox[
     RowBox[{"n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"Coth", "[", "\[Gamma]", "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Coth", "[", "\[Gamma]", "]"}]}], ")"}], " ", 
         RowBox[{"Hypergeometric1F1", "[", 
          RowBox[{"i", ",", "n", ",", 
           RowBox[{"2", " ", "\[Gamma]"}]}], "]"}]}]}], ")"}]}], 
     RowBox[{"2", " ", "i", " ", 
      RowBox[{"(", 
       RowBox[{"i", "-", "n"}], ")"}]}]]}], TraditionalForm]],ExpressionUUID->
  "3a9b8284-e6f1-4ca6-bddc-6f74b22edd97"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Lim", "(", 
     RowBox[{
      RowBox[{"F", "(", 
       RowBox[{"n", ",", "i", ",", "\[Gamma]"}], ")"}], ",", 
      RowBox[{"\[Gamma]", "->", "0"}]}], ")"}], "=", 
    FractionBox["1", "i"]}], TraditionalForm]],ExpressionUUID->
  "f7b37e30-6415-4a8c-9543-05ee57478573"],
 "   "
}], "Text",
 CellChangeTimes->{{3.6049658220203104`*^9, 3.604965827361318*^9}, {
   3.604966007712572*^9, 3.6049661162047243`*^9}, {3.6049661506777725`*^9, 
   3.6049661894338274`*^9}, {3.892820715257493*^9, 3.8928207521852713`*^9}, {
   3.892821222731608*^9, 3.892821271036702*^9}, {3.8928213442047186`*^9, 
   3.892821398220025*^9}, {3.8928214702292795`*^9, 3.892821593649423*^9}, {
   3.892821633090165*^9, 3.892821648590603*^9}, {3.8928216987031107`*^9, 
   3.892821816927553*^9}, {3.892821978148059*^9, 3.892822005547213*^9}, 
   3.892822036496767*^9, {3.8928220950417414`*^9, 3.89282214344637*^9}, {
   3.892822197938811*^9, 3.892822212021909*^9}, {3.892823183941673*^9, 
   3.8928234891118174`*^9}, {3.8928235769206123`*^9, 
   3.8928235810486565`*^9}, {3.894124835043976*^9, 3.8941249937403145`*^9}, 
   3.8941252239453163`*^9, 3.895731922930401*^9, {3.8957352636826105`*^9, 
   3.8957352815131316`*^9}, {3.8957353131586804`*^9, 
   3.8957353142928877`*^9}, {3.8957365072665787`*^9, 
   3.8957365752835984`*^9}, {3.8963431812338867`*^9, 
   3.8963431969143305`*^9}, {3.896343289955268*^9, 3.896343329750311*^9}, {
   3.89634342957594*^9, 
   3.8963434336376057`*^9}},ExpressionUUID->"30e93724-d4ad-4884-a678-\
57f0e8905f69"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the integrated DFE", "Subsection",
 CellChangeTimes->{{3.9011774729148674`*^9, 
  3.9011774809958906`*^9}},ExpressionUUID->"19b67809-122f-498c-9bc1-\
b22727a24624"],

Cell[TextData[{
 "Boyko\[CloseCurlyQuote]s expression, rearranged a bit, for the Poisson rate \
for bin ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", " "}], TraditionalForm]],ExpressionUUID->
  "5d0cd494-55f0-4b10-a766-7b3ec9153b96"],
 " is \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Theta]", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "m"], 
      RowBox[{
       RowBox[{"g", "(", "\[Gamma]", ")"}], 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "1"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {"n"},
            {"i"}
           }], ")"}], 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["q", "i"], "(", 
           RowBox[{"1", "-", "q"}], ")"}], 
          RowBox[{"n", "-", "i"}]], 
         RowBox[{"f", "(", 
          RowBox[{"q", ";", "\[Gamma]"}], ")"}], 
         RowBox[{"\[DifferentialD]", "q"}], 
         RowBox[{"\[DifferentialD]", "\[Gamma]"}]}]}]}]}]}], "=", " ", 
    RowBox[{"\[Theta]", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "m"], 
      RowBox[{
       RowBox[{"g", "(", "\[Gamma]", ")"}], 
       RowBox[{"F", "[", 
        RowBox[{"n", ",", "i", ",", "\[Gamma]"}], "]"}], 
       RowBox[{"\[DifferentialD]", "\[Gamma]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"212b77c6-e100-44d5-a9eb-d9a1eb68c777"],
 "  where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{"q", ",", "\[Gamma]"}], ")"}], "=", 
    FractionBox[
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"\[Gamma]", "(", 
           RowBox[{"1", "-", "q"}], ")"}]}]]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], "\[Gamma]"}]]}], ")"}], 
      RowBox[{"q", "(", 
       RowBox[{"1", "-", "q"}], ")"}]}]]}], TraditionalForm]],ExpressionUUID->
  "b869701b-ec06-46ae-9899-d40a1bc5fcfe"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "(", "\[Gamma]", ")"}], TraditionalForm]],ExpressionUUID->
  "a22f9102-d611-4053-b993-7b4a60fe6758"],
 " is the DFE \nThis gives us a rate for the Poisson distribution.  e.g. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalF]", "(", 
     RowBox[{"n", ",", "i"}], ")"}], "=", 
    RowBox[{"\[Theta]", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "m"], 
      RowBox[{
       RowBox[{"g", "(", "\[Gamma]", ")"}], 
       RowBox[{"F", "[", 
        RowBox[{"n", ",", "i", ",", "\[Gamma]"}], "]"}], 
       RowBox[{"\[DifferentialD]", "\[Gamma]"}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "902c41ac-bb28-4a88-9400-76e612d027a4"]
}], "Text",
 CellChangeTimes->{{3.9011775029991136`*^9, 3.901177507410661*^9}, {
  3.9011775484513936`*^9, 3.901177621550218*^9}, {3.901790406611306*^9, 
  3.901790466207739*^9}},ExpressionUUID->"aeedbc04-0a96-427a-983f-\
cd1b0d82f89b"],

Cell[CellGroupData[{

Cell["Numerical integration of the DFE ", "Subsubsection",
 CellChangeTimes->{{3.9004197435634212`*^9, 3.90041975006022*^9}, {
  3.9017190575937805`*^9, 
  3.9017190663132257`*^9}},ExpressionUUID->"0b9ecceb-4dff-41d5-8d7a-\
af103e7f9e98"],

Cell[TextData[{
 "Suppose we had ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "210023d1-b513-4f5c-90bb-182dca409ceb"],
 " fitness values, and for each there was a probability that a new mutation \
fell in that fitness class.  Let ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Phi]", "j"], TraditionalForm]],ExpressionUUID->
  "2e249b7c-9d7a-4439-9cab-b8a44cc8fff4"],
 " be the probability that a mutation falls in fitness class ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]],ExpressionUUID->
  "9c65abfe-abba-456d-9e92-949daa049db1"],
 ".   \[CapitalPhi] can be the probabilities,  and \[CapitalGamma] can be the \
corresponding values of \[Gamma]. Then the probability of observing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "i"], TraditionalForm]],ExpressionUUID->
  "53822eed-4e31-4314-b595-f4984c92db0c"],
 " sites in frequency class ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "406147f3-89a1-471c-b908-0c075a75d581"],
 " would be something like\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["X", "i"], "|", "\[Theta]"}], ",", "\[CapitalPhi]", ",", 
      " ", "\[CapitalGamma]"}], ")"}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "k"], 
     FractionBox[
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[Theta]"}], "  ", 
          SubscriptBox["\[Phi]", "j"], 
          RowBox[{"F", "(", 
           RowBox[{"i", ",", 
            SubscriptBox["\[Gamma]", "j"]}], ")"}]}]], "(", 
        RowBox[{"\[Theta]", " ", 
         SubscriptBox["\[Phi]", "j"], 
         RowBox[{"F", "(", 
          RowBox[{"i", ",", 
           SubscriptBox["\[Gamma]", "j"]}], ")"}]}], ")"}], 
       SubscriptBox["x", 
        RowBox[{"i", ",", "j"}]]], 
      RowBox[{
       SubscriptBox["x", 
        RowBox[{"i", ",", "j"}]], "!"}]]}]}], TraditionalForm]],
  ExpressionUUID->"17c1a6c8-b288-48f9-818b-ca6e55055dcb"],
 "+\nHowever we do not know what the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"i", ",", "j"}]], TraditionalForm]],ExpressionUUID->
  "c29ab656-3748-4ba0-be64-39ed9c583515"],
 " values are.   In fact this is a convolution, in which case this becomes \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["X", "i"], "|", "\[Theta]"}], ",", "\[CapitalPhi]", ",", 
      " ", "\[CapitalGamma]"}], ")"}], "=", 
    FractionBox[
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Theta]"}], "  ", 
         SubscriptBox["\[ScriptCapitalR]", "i"]}]], "(", 
       RowBox[{"\[Theta]", " ", 
        SubscriptBox["\[ScriptCapitalR]", "i"]}], ")"}], 
      SubscriptBox["x", "i"]], 
     RowBox[{
      SubscriptBox["x", "i"], "!"}]]}], TraditionalForm]],ExpressionUUID->
  "e5f0d44b-49a6-4dd0-a69e-b8179610d7c7"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalR]", "i"], "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "k"], " ", 
     RowBox[{
      SubscriptBox["\[Phi]", "j"], 
      RowBox[{"F", "(", 
       RowBox[{"i", ",", 
        SubscriptBox["\[Gamma]", "j"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"c6669af8-4d04-4d1b-8603-98e423158c10"],
 "\nThis is just useful as a reminder that we can integrate, e.g. \
numerically, over some density for \[Gamma] and that the result will still be \
a Poisson rate for bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "3fc00a49-e41b-4d41-9cf6-fa219c6f1911"],
 ". \nWould we have any access to \[CapitalPhi]  ??    i.e. some arbitrary \
discrete distribution?  Probably not as it would have too many terms. "
}], "Text",
 CellChangeTimes->{{3.8989617744533324`*^9, 3.898961779907942*^9}, {
   3.8989618186227207`*^9, 3.8989618599677706`*^9}, {3.8989619163726034`*^9, 
   3.8989619250101147`*^9}, {3.898961960090625*^9, 3.8989620049892025`*^9}, {
   3.898962044254939*^9, 3.8989620911647077`*^9}, {3.8989621219142265`*^9, 
   3.8989622986837626`*^9}, {3.8989623540876684`*^9, 
   3.8989623813476653`*^9}, {3.8989624481627035`*^9, 
   3.8989625653342805`*^9}, {3.898962636769024*^9, 3.8989626503271184`*^9}, {
   3.898962854376378*^9, 3.8989628696550145`*^9}, {3.8989629210795116`*^9, 
   3.89896297769839*^9}, 3.899891123048034*^9, {3.899968562138077*^9, 
   3.8999685627136087`*^9}, {3.9004012138243794`*^9, 3.9004012143763895`*^9}, 
   3.900419656730997*^9, {3.90041970910046*^9, 3.9004197118685193`*^9}, {
   3.900419755200944*^9, 3.9004197634207153`*^9}, 3.9011776576290894`*^9, {
   3.9011777277878017`*^9, 
   3.9011778477628646`*^9}},ExpressionUUID->"679d2cae-3092-4b6d-a642-\
e33e35ff1d8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Analytical Integrating over a density for ",
 Cell[BoxData[
  FormBox["\[Gamma]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "01b8d15c-4319-4abd-8921-c34f4f90d480"],
 "  - does not work"
}], "Subsubsection",
 CellChangeTimes->{{3.900768000230402*^9, 3.900768025145554*^9}, {
   3.9007694502186737`*^9, 3.9007694576359725`*^9}, {3.9008308606178784`*^9, 
   3.900830860759841*^9}, 3.9011779238059835`*^9, {3.9017190846484604`*^9, 
   3.901719092143811*^9}},ExpressionUUID->"619a5269-47ac-41f6-8e94-\
22e93bc5d6c7"],

Cell[TextData[{
 "If we have a density ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "(", "\[Gamma]", ")"}], TraditionalForm]],ExpressionUUID->
  "ce980474-c057-40ad-94f4-5c122d34b01c"],
 " then we can try to solve this, to get our ",
 Cell[BoxData[
  FormBox[
   RowBox[{"F", "(", 
    RowBox[{"n", ",", "i", ",", "..."}], ")"}], TraditionalForm]],
  ExpressionUUID->"ab0760d5-dba9-490a-b551-5b285670347b"],
 ".\nFor the shift gamma distribution (See below)   ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", 
     RowBox[{
      RowBox[{"\[Gamma]", ";", "\[Alpha]"}], ",", "\[Beta]", ",", "m"}], 
     ")"}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "\[Gamma]"}], ")"}], 
       RowBox[{"\[Alpha]", "-", "1"}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"m", "-", "\[Gamma]"}], ")"}]}], "/", "\[Beta]"}]]}], 
     RowBox[{
      RowBox[{"Gamma", "[", "\[Alpha]", "]"}], " ", 
      SuperscriptBox["\[Beta]", "\[Alpha]"]}]]}], TraditionalForm]],
  ExpressionUUID->"4f1aa34e-2a63-49e2-b978-142e864d760c"],
 "\n\nFor the reflected and shifted lognormal distribution (see below) ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", 
     RowBox[{
      RowBox[{"\[Gamma]", ";", " ", "u"}], ",", "\[Sigma]", ",", "m"}], ")"}],
     "=", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{
              RowBox[{"-", "\[Gamma]"}], "+", "m"}], "]"}], "-", "u"}], ")"}],
           "2"]}], "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], ")"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], "+", "m"}], ")"}], " ", "\[Sigma]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", " ", "\[Pi]"}], ")"}], 
       RowBox[{"1", "/", "2"}]]}]]}], TraditionalForm]],ExpressionUUID->
  "c4563282-25e3-4596-a220-b79a0a020f06"],
 "\n\nHowever this does not simplify, for either gamma or lognormal .\nNor \
does it help to reverse the order of integration and integrate over \[Gamma] \
before q. "
}], "Text",
 CellChangeTimes->{{3.9007681336511126`*^9, 3.9007681963903594`*^9}, {
   3.900768239353335*^9, 3.90076828572138*^9}, {3.9007684676086793`*^9, 
   3.9007685242513523`*^9}, {3.900768844960111*^9, 3.9007688658830996`*^9}, {
   3.9007689198640385`*^9, 3.900768937581117*^9}, {3.9007694658839703`*^9, 
   3.9007696056890593`*^9}, {3.9007697204959245`*^9, 
   3.9007698115011253`*^9}, {3.9007725632049074`*^9, 3.900772567747183*^9}, {
   3.900827550530341*^9, 3.9008275552814765`*^9}, {3.9008275871797075`*^9, 
   3.900827624951771*^9}, {3.9008308804333096`*^9, 3.9008308874512644`*^9}, {
   3.900830927461584*^9, 3.900830927461584*^9}, {3.900925895950427*^9, 
   3.900925900945593*^9}, {3.900926204851192*^9, 3.900926224030143*^9}, 
   3.9011774960660095`*^9, {3.901719476868888*^9, 3.9017194774879723`*^9}, {
   3.9022440678808928`*^9, 
   3.9022440696521378`*^9}},ExpressionUUID->"f44d02cd-ac85-43b9-ba7a-\
5dc7cc60a92d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Working with densities for \[Gamma] for normal,  lognormal and gamma \
distributions
\
\>", "Subsection",
 CellChangeTimes->{{3.8999081005068464`*^9, 3.899908113788746*^9}, {
   3.900056428285393*^9, 3.900056434125849*^9}, {3.900073480338232*^9, 
   3.900073498033883*^9}, 
   3.9022441306828194`*^9},ExpressionUUID->"634987fd-e3d6-4fd7-884f-\
2e06e9075589"],

Cell["\<\
We need a distribution that has the right shape.  If necessary we can reflect \
a distribution about zero and shift it to the right or left.  The use \
reflected gamma distributions was mentioned by Keightley PD, Halligan DL. \
2009. Analysis and implications of mutational variation. Genetica 136:359-369.\
\>", "Text",
 CellChangeTimes->{{3.9022441383502264`*^9, 
  3.902244187739501*^9}},ExpressionUUID->"cba2d235-1d85-450d-beb4-\
99131f17c1e1"],

Cell[CellGroupData[{

Cell["Normal distribution", "Subsubsection",
 CellChangeTimes->{{3.8999081198202724`*^9, 3.8999081691644115`*^9}, {
  3.899908231150052*^9, 3.8999083003043766`*^9}, {3.9000735793966737`*^9, 
  3.9000735875400443`*^9}},ExpressionUUID->"86c1d177-40c7-44fa-8487-\
296a5bd4a6d3"],

Cell["\<\
Trying out arbitrary discrete distributions did not go great.  But using a \
normal density worked pretty well.  However the general form is not ideal.  \
We probably want something that is not symmetric,  but has a mode near 0 \
(i.e. neutrality).  \
\>", "Text",
 CellChangeTimes->{{3.8999081198202724`*^9, 3.8999081691644115`*^9}, {
   3.899908231150052*^9, 3.8999083003043766`*^9}, 
   3.9000735793966737`*^9},ExpressionUUID->"12e8b4ae-af9a-47bc-9080-\
829ed10a9a84"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lognormal distribution", "Subsubsection",
 CellChangeTimes->{{3.9000736054293313`*^9, 
  3.9000736085005517`*^9}},ExpressionUUID->"6582c419-bf47-49c7-9a67-\
753cf3519e41"],

Cell[TextData[{
 "A density that seems more useful would be lognormal. We want to try out the \
lognormal distribution because we like the shape.  Or rather the shape may be \
useful if we reflect it about zero and shift the random variable\
\[CloseCurlyQuote]s range. \n\n\n\nSome explanation.   The lognormal is not a \
conventional probability density. \nThe way it is defined,  we say that  a \
variable ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", " "}], TraditionalForm]],ExpressionUUID->
  "c3506789-cfda-45bc-a7f7-04c0c01f43c4"],
 " is lognormally distributed if ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "fbc04ec9-0310-4095-8f10-bbab16755e79"],
 " is normally distributed and if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", 
    RowBox[{"Log", "[", "X", "]"}]}], TraditionalForm]],ExpressionUUID->
  "1fadd7ba-5a72-4419-98a9-7639e44a91c3"],
 ".    Alternatively if ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "b8f4300d-49e1-493d-af55-9648c092f62e"],
 " is a normally distributed random variable,  then ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    SuperscriptBox["\[ExponentialE]", "Y"]}], TraditionalForm]],
  ExpressionUUID->"4c2e62b4-824d-49e4-971b-aa5e213fec4a"],
 " is lognormally distributed. \n\nIn other words,  we are sampling the \
natural logarithm of ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "def316d5-80a0-4385-af12-703c6113f46f"],
 " from a normal distribution and then taking the exponential of that, and \
looking at this distribution (i.e. the exponential of what has been sampled \
from a normal distribution).  This means there can be no negative values. \n\
There are several common parameterizations of the lognormal distribution.  \
The one we are using here is what is in the wikipedia article.  Even though \
it uses \[OpenCurlyQuote]mean\[CloseCurlyQuote] and \[OpenCurlyQuote]variance\
\[CloseCurlyQuote] in its parameterization,  these terms apply to the the \
density of ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "89d89211-e3b7-42c5-8f39-0fbc13fe722b"],
 " not ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "=", 
    SuperscriptBox["\[ExponentialE]", "Y"], " "}], TraditionalForm]],
  ExpressionUUID->"4d51b6f5-bd21-4536-affe-03895e44545e"],
 ".  The mean and variance for ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "93996871-8f79-47a4-a198-637a507280db"],
 " are functions of the mean and variance of ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "49a0ed19-3fd7-4d5c-abc7-cc4bafae5c01"],
 ", and we don\[CloseCurlyQuote]t really have useful names for the parameters \
in ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "2812d0ba-22aa-46c6-8270-2cef4d7dd5d1"],
 " \n\nIf ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "d4648098-f8c2-4e60-9a9c-9665b38ddcc3"],
 " has mean u and standard deviation \[Sigma],  then  the density function \
for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", " "}], TraditionalForm]],ExpressionUUID->
  "56bdd89c-bde2-4699-85aa-c6be3ddccdf6"],
 " is given by (found this in the wikipedia article) ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", "x", "]"}], "-", "u"}], ")"}], "2"]}], "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], ")"}]], 
     RowBox[{"x", " ", "\[Sigma]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", " ", "\[Pi]"}], ")"}], 
       RowBox[{"1", "/", "2"}]]}]]}], TraditionalForm]],ExpressionUUID->
  "7bc8e0a8-7c97-4a1b-9733-7b8246cfbb61"],
 "\n\nLetting ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "x"], TraditionalForm]],ExpressionUUID->
  "01b1079b-3806-4bda-8bf2-d5789e7d8d7f"],
 " be the mean of this distribution we find that  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", "x"], "=", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"u", "+", 
      FractionBox[
       SuperscriptBox["\[Sigma]", "2"], "2"]}]]}], TraditionalForm]],
  ExpressionUUID->"e2052a7f-7654-49bc-829e-d6fe5115d243"],
 "\nGoing the other way,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{
     RowBox[{"Log", "[", 
      SubscriptBox["u", "x"], "]"}], " ", "-", " ", 
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "/", "2"}]}]}], TraditionalForm]],
  ExpressionUUID->"ae86f038-e384-49e4-aab7-8f42ccf8a892"],
 "\nSo if we wanted a lognormal variable to have a mean of ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]],ExpressionUUID->
  "36f70d08-8dd5-4b6d-81e8-6d89324466b3"],
 " we would find ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Log", "[", "z", "]"}], "-", 
    RowBox[{
     SuperscriptBox["\[Sigma]", "2"], "/", "2"}]}], TraditionalForm]],
  ExpressionUUID->"9571a64b-cd6b-41f5-83ca-7befa4d13bb1"],
 "  and then use the lognormal density function \n\nFor the variance,  we \
find that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"E", "[", 
     SuperscriptBox["x", "2"], "]"}], "=", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"u", "+", 
        SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]]}], TraditionalForm]],
  ExpressionUUID->"c456e124-d9b7-4fe9-b0b1-3a3e74542ebe"],
 " so ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Var", "[", "X", "]"}], " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"E", "[", 
       SuperscriptBox["x", "2"], "]"}], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"E", "(", "x", ")"}], ")"}], "2"]}], "=", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "x"], "2"], "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", 
            SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"u", "+", 
            FractionBox[
             SuperscriptBox["\[Sigma]", "2"], "2"]}]], ")"}], "2"]}], "=", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"2", " ", "u"}], "+", 
          SuperscriptBox["\[Sigma]", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           SuperscriptBox["\[Sigma]", "2"]]}], ")"}]}]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"5fb1d84e-816a-47d5-8a55-9bdfa7031dc3"],
 " \nGoing the other way we find ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "=", 
    RowBox[{"Log", "[", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "u"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "u"}]], "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"4", " ", "u"}]], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", "u"}]], " ", 
           SuperscriptBox[
            SubscriptBox["\[Sigma]", "x"], "2"]}]}]]}], ")"}]}], "]"}]}], 
   TraditionalForm]],ExpressionUUID->"e3f7425d-a12d-4b61-a4b5-2cd6c1257d8c"],
 "\nThe mode of ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "f12ce760-d6bb-42b6-88c1-af0cc590086a"],
 " is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"u", "-", 
     SuperscriptBox["\[Sigma]", "2"]}]], TraditionalForm]],ExpressionUUID->
  "138bf1e4-b0eb-4d67-b739-4bbb6baa8b15"]
}], "Text",
 CellChangeTimes->{{3.8998924814247246`*^9, 3.8998925209445267`*^9}, {
   3.8998936854337096`*^9, 3.899893692553816*^9}, {3.8998976042418895`*^9, 
   3.899897694051882*^9}, {3.899897738770802*^9, 3.8998977772206144`*^9}, {
   3.899898205173581*^9, 3.8998982239256916`*^9}, {3.8998983734305696`*^9, 
   3.8998984209028516`*^9}, {3.899898613415986*^9, 3.8998986822003913`*^9}, {
   3.899898729007675*^9, 3.899898744747307*^9}, {3.899898864937358*^9, 
   3.8998988835643153`*^9}, {3.8998990517885265`*^9, 
   3.8998991509551306`*^9}, {3.899899309644014*^9, 3.8998993283991547`*^9}, {
   3.8998993600443397`*^9, 3.8998994164315443`*^9}, {3.8998994667714963`*^9, 
   3.8998994837925744`*^9}, {3.8998998985274506`*^9, 3.899899937459237*^9}, {
   3.8999001473796663`*^9, 3.8999001543209085`*^9}, {3.8999019436760983`*^9, 
   3.899902129008643*^9}, {3.899902576005678*^9, 3.8999026249806643`*^9}, 
   3.899902765739801*^9, {3.899903403623304*^9, 3.8999034673170147`*^9}, {
   3.899907559551016*^9, 3.899907565071735*^9}, {3.899907923735858*^9, 
   3.8999080646196756`*^9}, 3.8999081547513742`*^9, {3.9000728890900106`*^9, 
   3.900072889755005*^9}, {3.9000731268120084`*^9, 3.9000732763720975`*^9}, {
   3.902244081462366*^9, 
   3.902244127238017*^9}},ExpressionUUID->"bc81a6b4-03f9-4375-9d1a-\
9b876621c929"],

Cell[TextData[{
 "To make it useful for our purpose,  let\[CloseCurlyQuote]s rescale this by \
flipping it around and shifting it to the right a bit, so the upper bound is \
greater than 0 but most of the density is in the negative range. \n\nWe still \
use variable ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "d80e88ea-edb4-429e-9d15-475bf0c5f7fd"],
 " but for the density we take its negative and shift it by a factor ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "664cd85e-299c-4a41-ab71-78f1ea798c33"],
 " where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", ">", " ", "0"}], TraditionalForm]],ExpressionUUID->
  "6ae960fc-b04e-4d24-af84-de538e3f6cd9"],
 " \nThis should go from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "\[Infinity]"}], TraditionalForm]],ExpressionUUID->
  "ca0c8a62-5d8c-4ac9-aafe-5bf66c93fb51"],
 " to ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "82be76b0-84c0-4488-8264-c55b13453a80"],
 " and have density function ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{"-", "x"}], "+", "m"}], "]"}], "-", "u"}], ")"}], "2"]}],
        "/", 
       RowBox[{"(", 
        RowBox[{"2", 
         SuperscriptBox["\[Sigma]", "2"]}], ")"}]}], ")"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "x"}], "+", "m"}], ")"}], " ", "\[Sigma]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", " ", "\[Pi]"}], ")"}], 
      RowBox[{"1", "/", "2"}]]}]], TraditionalForm]],ExpressionUUID->
  "1d4a6168-1c9f-4131-9680-2652917fd004"],
 "\nIntegration of this is 1. \nThe mean of this new ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "42cd1430-cb7f-4ec1-8318-5ae736b815ef"],
 " is simply ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", "x"], "=", 
    RowBox[{"m", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"u", "+", 
       FractionBox[
        SuperscriptBox["\[Sigma]", "2"], "2"]}]]}]}], TraditionalForm]],
  ExpressionUUID->"b06f7810-ef5b-432e-b47c-ff03c8e857a7"],
 "  and the variance is unchanged ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "x"], "2"], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"2", " ", "u"}], "+", 
       SuperscriptBox["\[Sigma]", "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        SuperscriptBox["\[Sigma]", "2"]]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"e659aad6-9717-46ef-a1a9-529a71673674"],
 "\n\nIf we have values of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "x"], TraditionalForm]],ExpressionUUID->
  "02569f8e-c556-4df9-b6e3-446901a8448e"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "x"], TraditionalForm]],ExpressionUUID->
  "efbe0931-ed27-4563-80d3-08bc77c45019"],
 " and ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "2b413ce9-26ef-4735-abfb-ae48ac0e015f"],
 " in mind, and wish to jointly solve for values of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", " ", "and", " ", "\[Sigma]"}], TraditionalForm]],
  ExpressionUUID->"7ed3b03c-3bcb-4559-94bd-af99cc5bd288"],
 " in order to get them then \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sigma]", "=", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"Log", "[", 
        FractionBox[
         SqrtBox[
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           RowBox[{"2", " ", "m", " ", 
            SubscriptBox["u", "x"]}], "+", 
           SuperscriptBox[
            SubscriptBox["u", "x"], "2"], "+", 
           SuperscriptBox[
            SubscriptBox["\[Sigma]", "x"], "2"]}]], 
         RowBox[{"Abs", "[", 
          RowBox[{"m", "-", 
           SubscriptBox["u", "x"]}], "]"}]], "]"}]}], ")"}], 
     RowBox[{"1", "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "a36bbdcc-de68-4d54-8280-dce4d16f8376"],
 "and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", 
         SubscriptBox["u", "x"]}], ")"}], " ", 
       RowBox[{"Abs", "[", 
        RowBox[{"m", "-", 
         SubscriptBox["u", "x"]}], "]"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["m", "2"], "-", 
        RowBox[{"2", " ", "m", " ", 
         SubscriptBox["u", "x"]}], "+", 
        SuperscriptBox[
         SubscriptBox["u", "x"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["\[Sigma]", "x"], "2"]}]]], "]"}]}], TraditionalForm]],
  ExpressionUUID->"640f81f3-3631-4e61-b392-3bfb74e094a5"],
 "\nThis seems to work.   \n\nThe mode, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalM]", "=", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "-", 
        SuperscriptBox["\[Sigma]", "2"]}]]}], "+", "m"}]}], TraditionalForm]],
  ExpressionUUID->"28e07e0a-9fe1-4057-aae7-adf439f44f89"],
 "   \n\nIf we have a mode \[ScriptCapitalM] and ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "c3f8362c-c835-42ad-af93-fa0b79e74c0c"],
 " in mind,  and wish to solve for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", " ", "and", " ", "\[Sigma]"}], TraditionalForm]],
  ExpressionUUID->"79baf392-0935-4953-a3de-60e1fcabaf8a"],
 " in order to get them then\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"m", "-", "\[ScriptCapitalM]"}], "]"}], "+", 
     SuperscriptBox["\[Sigma]", "2"], "   "}]}], TraditionalForm]],
  ExpressionUUID->"343c7b25-ec7a-4f2f-95aa-2f27f9756849"],
 " but we can\[CloseCurlyQuote]t jointly find ",
 Cell[BoxData[
  FormBox["u", TraditionalForm]],ExpressionUUID->
  "56d4fd9d-3302-4f21-871d-046e460b48fc"],
 " and \[Sigma] using only \[ScriptCapitalM] and ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "39e81856-7e4f-4b72-9aad-5de3f8ed8c21"],
 "\n\nIf we want the mode to be 0,  then ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "==", 
    RowBox[{"Log", "[", 
     RowBox[{"u", "-", 
      SuperscriptBox["\[Sigma]", "2"]}], "]"}]}], TraditionalForm]],
  ExpressionUUID->"f3eb44de-5024-4738-a0ed-61d3ef90534a"],
 "\nIf  \[ScriptCapitalM]=0 and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "1", " "}], TraditionalForm]],ExpressionUUID->
  "177d2934-b9c2-4dc1-bc7a-defffae7b7ca"],
 "then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"u", "-", 
      SuperscriptBox["\[Sigma]", "2"]}]], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"33495d39-19ff-4ac6-b46f-c5b634951297"],
 " which means that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "==", 
    SuperscriptBox["\[Sigma]", "2"]}], TraditionalForm]],ExpressionUUID->
  "d826a821-bbfe-40ae-9527-cf0599bc177d"],
 "\nif \[ScriptCapitalM]=0 and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "2"}], TraditionalForm]],ExpressionUUID->
  "9148d2d9-acb6-4705-8314-6ae65ad3c680"],
 " then  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"u", "-", 
      SuperscriptBox["\[Sigma]", "2"]}]], "=", "2"}], TraditionalForm]],
  ExpressionUUID->"55b83fc1-01e8-4d23-86e0-9e925c95c264"],
 " which means that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"u", "-", 
     SuperscriptBox["\[Sigma]", "2"]}], "=", 
    RowBox[{"Log", "[", "2", "]"}]}], TraditionalForm]],ExpressionUUID->
  "f880ba7e-58dc-480e-8538-948fe5f3e768"],
 "\n\n"
}], "Text",
 CellChangeTimes->{{3.8999001585769353`*^9, 3.899900258899476*^9}, {
   3.8999002905166836`*^9, 3.8999002905166836`*^9}, {3.8999006295142903`*^9, 
   3.899900634345456*^9}, 3.8999008305482035`*^9, {3.8999009094956093`*^9, 
   3.899900950154015*^9}, {3.8999010162367373`*^9, 3.8999010517456183`*^9}, {
   3.899901131411775*^9, 3.899901237735773*^9}, {3.899902782506461*^9, 
   3.899902842239911*^9}, {3.8999029209779234`*^9, 3.899902923971084*^9}, {
   3.8999030608853683`*^9, 3.899903306511073*^9}, {3.8999034737491646`*^9, 
   3.899903474773696*^9}, {3.8999040040556107`*^9, 3.8999040603338227`*^9}, {
   3.899904278835251*^9, 3.899904299329977*^9}, {3.899904542191996*^9, 
   3.8999045932963123`*^9}, {3.8999048435582733`*^9, 
   3.8999049190330887`*^9}, {3.8999076014397*^9, 3.899907686962868*^9}, {
   3.9011098648135777`*^9, 
   3.901109872014554*^9}},ExpressionUUID->"bd612c75-75fe-4cc0-bdaa-\
c76858bb9728"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "solving", " ", "for", " ", "terms", " ", "of", " ", "the", " ", "normal", 
   " ", "distribution", " ", "of", " ", "which", " ", "we", " ", "are", " ", 
   "taking", " ", "the", " ", "exponential"}], "  ", "*)"}]], "Input",
 CellChangeTimes->{{3.900056360143718*^9, 3.900056391822189*^9}, {
  3.9000564555827665`*^9, 
  3.900056466686353*^9}},ExpressionUUID->"afe4a451-8e8f-4fc1-9c30-\
1c1bca963c7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getus", "[", 
   RowBox[{"ux_", ",", "\[Sigma]x_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "ux"}], ")"}], " ", 
        RowBox[{"Abs", "[", 
         RowBox[{"m", "-", "ux"}], "]"}]}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["m", "2"], "-", 
         RowBox[{"2", " ", "m", " ", "ux"}], "+", 
         SuperscriptBox["ux", "2"], "+", 
         SuperscriptBox["\[Sigma]x", "2"]}]]], "]"}], ",", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"Log", "[", 
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"2", " ", "m", " ", "ux"}], "+", 
            SuperscriptBox["ux", "2"], "+", 
            SuperscriptBox["\[Sigma]x", "2"]}]], 
          RowBox[{"Abs", "[", 
           RowBox[{"m", "-", "ux"}], "]"}]], "]"}]}], ")"}], 
      RowBox[{"1", "/", "2"}]], ",", "m"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9000563518408594`*^9, 3.9000563576946983`*^9}, {
  3.9000564898884087`*^9, 3.9000564918393497`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"0518f4be-fbd3-4b1e-97e8-28e430950878"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getus", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.9000564747049007`*^9, 3.900056485054691*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"328adada-8a05-4350-9a1a-a0c5331fed41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5815754049028404`", ",", "0.47238072707743894`", ",", "1.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9000565145229173`*^9},
 CellLabel->
  "Out[198]=",ExpressionUUID->"5f4ed0f2-57e1-4874-8766-23a1503c8939"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"getus", "[", 
  RowBox[{
   RowBox[{"-", "2"}], ",", "2", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.9000565087184105`*^9, 3.9000565277270155`*^9}},
 CellLabel->"",ExpressionUUID->"2cfcc38d-d163-461b-a407-e3f9cc3114b1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.900056519982958*^9, 
  3.900056519985957*^9}},ExpressionUUID->"8f87be04-4fd0-4855-a2ff-\
4a9c344e37c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gamma distribution", "Subsubsection",
 CellChangeTimes->{{3.9000736234296513`*^9, 
  3.9000736294611797`*^9}},ExpressionUUID->"3596b9f5-daf2-4807-979b-\
06d1b8488405"],

Cell[TextData[{
 "How about a gamma distribution,  which is non-zero.  \nThis should be \
pretty similar to working with lognormal distribution.  In both cases we \
would reflect and shift. \n\n\[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["GammaDistribution"]], "paclet:ref/GammaDistribution"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    StyleBox["\[Alpha]", "TR"], ",", 
    StyleBox["\[Beta]", "TR"], ",", 
    StyleBox["\[Gamma]", "TR"], ",", 
    StyleBox["\[Mu]", "TR"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "fd5e263d-6a16-42ca-af3a-a2eb4abd7fc1"],
 "  represents a generalized gamma distribution with shape parameters ",
 Cell[BoxData[
  StyleBox["\[Alpha]", "TR"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "3bd08dc9-ccfc-4741-b2f1-d7f6c30852e0"],
 " and ",
 Cell[BoxData[
  StyleBox["\[Gamma]", "TR"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "bab0276d-7515-4d4b-83ac-ddcf6ff7d0c9"],
 ", scale parameter ",
 Cell[BoxData[
  StyleBox["\[Beta]", "TR"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "74f70763-332d-464d-80e6-aa5dfe0e7148"],
 ".\[CloseCurlyDoubleQuote]\nThe density function is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "x", ")"}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["x", 
       RowBox[{"\[Alpha]", "-", "1"}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "x"}], "/", "\[Beta]"}]]}], 
     RowBox[{
      RowBox[{"Gamma", "[", "\[Alpha]", "]"}], " ", 
      SuperscriptBox["\[Beta]", "\[Alpha]"]}]]}], TraditionalForm]],
  ExpressionUUID->"0db173ea-5888-4c58-ae3b-76c3ef11695b"],
 "\nThis has mean \[Alpha] \[Beta] and variance \[Alpha] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Beta]", "2"], TraditionalForm]],ExpressionUUID->
  "f162189f-080e-4ae1-8811-f47330ec2a61"],
 "\nIf \[Alpha]<1,  the mode is 0, else the mode is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "-", "1"}], ")"}], " ", "\[Beta]"}], 
   TraditionalForm]],ExpressionUUID->"36846856-1e6a-4ca0-8ca7-1c19dd0686a5"],
 "  \n\nIf we flip and shift, as we did with the lognormal  then we are \
replacing ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "927628dc-522e-4628-b611-96e1193305d3"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "-", "x"}], TraditionalForm]],ExpressionUUID->
  "cfc4d492-f418-4b69-a91c-6eaa541712ae"],
 "\nThis has density ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "-", "x"}], ")"}], 
      RowBox[{"\[Alpha]", "-", "1"}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"m", "-", "x"}], ")"}]}], "/", "\[Beta]"}]]}], 
    RowBox[{
     RowBox[{"Gamma", "[", "\[Alpha]", "]"}], " ", 
     SuperscriptBox["\[Beta]", "\[Alpha]"]}]], TraditionalForm]],
  ExpressionUUID->"fab638d8-c6be-4a07-9581-2eef49ead105"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "\[Infinity]"}], "<", "x", "<", "m"}], TraditionalForm]],
  ExpressionUUID->"59c62259-ae83-46fe-85fe-34dbf87aef3d"],
 "  \nThe mean is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "-", 
    RowBox[{"\[Alpha]", " ", "\[Beta]"}]}], TraditionalForm]],ExpressionUUID->
  "380c785e-ab7e-4b4e-be02-28c104c26021"],
 " and  variance \[Alpha] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Beta]", "2"], TraditionalForm]],ExpressionUUID->
  "22123e2f-b267-44ba-9f3e-d8854ab2947b"],
 "\nIf \[Alpha]<1,  the mode is ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "e933e43e-c86c-410b-ae05-a8d43faa155c"],
 ", else the mode is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Alpha]", "-", "1"}], ")"}], " ", "\[Beta]"}]}], 
   TraditionalForm]],ExpressionUUID->"be805f79-8e54-4819-a672-d31069eda445"],
 "  \n"
}], "Text",
 CellChangeTimes->{{3.900073633337569*^9, 3.900073653174857*^9}, {
  3.9022442046165156`*^9, 
  3.9022442114777575`*^9}},ExpressionUUID->"7c197c16-77ef-43db-ba64-\
d34b904af14d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The density of the ratio of two Poisson ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"rv", "'"}], "s"}], TraditionalForm]],ExpressionUUID->
  "deb4c522-4c5a-4112-8b69-96cdf2723474"]
}], "Chapter",
 CellChangeTimes->{{3.895731880011959*^9, 3.8957319057683606`*^9}, {
  3.8957393947712927`*^9, 3.895739408750806*^9}, {3.8963538581538744`*^9, 
  3.8963538652346573`*^9}},ExpressionUUID->"1be03235-5c56-4720-a6c0-\
d90defe2a342"],

Cell[TextData[{
 "Suppose we have the SFSS and SFSN,    and for bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ba3dfe74-0a1e-49c3-bf3f-5a39d6067ca5"],
 " we have e.g. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["X", "i"], "~", "SFSS"}], TraditionalForm]],ExpressionUUID->
  "158d11d9-3bac-4d42-9c27-354b5f808d32"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Y", "i"], " ", "~", "SFSN"}], TraditionalForm]],
  ExpressionUUID->"2413f26e-8366-4fa4-9ba9-76a46944e606"],
 "  and we\[CloseCurlyQuote]d like the probability distribution for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "i"], "=", 
    RowBox[{
     SubscriptBox["X", "i"], "/", 
     SubscriptBox["Y", "i"]}]}], TraditionalForm]],ExpressionUUID->
  "652408f5-6166-4b80-9f7a-93186b2db659"],
 ".    If we had a density ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "(", 
    SubscriptBox["Z", "i"], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "59672e82-e236-478d-a885-ce371231ec41"],
 " then we could calculate the probability of a series of ratios as  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Product]", 
     RowBox[{"i", "=", "1"}]], 
    RowBox[{"p", "(", 
     SubscriptBox["Z", "i"], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "eb5ecd6d-4dc9-44c6-ac2e-2e67eefa32ac"],
 ".  \nWe could still take advantage of the fact that we can sum any bins we \
wish and the totals will still be Poisson distributed.  Say we want to use \
the folded distribution,  then  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["Z", "i"], "\[Prime]"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["X", "i"], "+", 
       SubscriptBox["X", 
        RowBox[{"n", "-", "i"}]]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["Y", "i"], "+", 
       SubscriptBox["Y", 
        RowBox[{"n", "-", "i"}]]}], ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f9eb3e31-1bef-4d00-be0d-d3766f9ae4ea"],
 " and this is still the ratio of two Poissons."
}], "Text",
 CellChangeTimes->{
  3.895731931598853*^9, {3.895739416382148*^9, 3.8957397106311274`*^9}, {
   3.8957409725114946`*^9, 3.8957411227708607`*^9}, {3.8957411709971795`*^9, 
   3.895741181424285*^9}, {3.895741251461441*^9, 3.8957415229452453`*^9}, {
   3.89574165610188*^9, 3.895741884431734*^9}, {3.8957419224223633`*^9, 
   3.895742004358389*^9}, {3.8957421090006056`*^9, 3.8957421167750683`*^9}, {
   3.895742991348387*^9, 3.8957430326060266`*^9}, {3.895743203440667*^9, 
   3.89574322787986*^9}, {3.895743625222623*^9, 3.8957436414271655`*^9}, {
   3.8957437890793023`*^9, 3.8957438301951666`*^9}, {3.8957463309739504`*^9, 
   3.895746371097906*^9}, {3.895757945388958*^9, 3.895757948530139*^9}, {
   3.8963438973566093`*^9, 3.896344046096691*^9}, {3.896362048345441*^9, 
   3.896362048968814*^9}, {3.9015328682361803`*^9, 3.901532871322071*^9}, {
   3.9015329261632123`*^9, 3.90153308964738*^9}, {3.9015331351533957`*^9, 
   3.901533182831706*^9}, {3.901533221648282*^9, 
   3.9015333045515604`*^9}},ExpressionUUID->"b74e8a98-fbec-49d7-b4f4-\
0a8670332df4"],

Cell[TextData[{
 "One tricky area is that the expectations of the ratio may not change very \
much as ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "0eefde41-a65d-4d87-9b9a-8ec7bf77c0ee"],
 " gets bigger,  but the variance should go up dramatically.   If this is a \
problem we could consider summing across adjacent bins in order to get larger \
values in the numerator or denominator.  "
}], "Text",
 CellChangeTimes->{{3.9015333086269407`*^9, 3.9015333655378675`*^9}, {
  3.901533417275933*^9, 
  3.9015335076298366`*^9}},ExpressionUUID->"42841424-d2c6-47f4-a159-\
be0b39474e62"],

Cell[TextData[{
 "There is a discussion of this in a MS thesis (Griffin, T. F. (1992). \
Distribution of the ratio of two Poisson random variables.)\nOne immediate \
problem is that the denominator could be 0,  and so ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "515e742c-56d6-4a0d-bb01-3a77d14aff65"],
 " can take on an undefined value. \nThe Griffin thesis considers the case of \
working with the truncated distribution ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["Y", "i"], "\[Prime]"], "|", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["Y", "i"], "\[Prime]"], 
       RowBox[{">", "0"}]}]}], ")"}], " "}], TraditionalForm]],ExpressionUUID->
  "62e16343-24a0-4dbd-bb23-59dc7544dbff"],
 " but calculating the result runs into sum issues. \nBecause the Poisson is \
a discrete distribution,  the ratio is also a discrete random variable,  and \
can have odd peaks and valleys for particular values of the ratio that can \
reoccur  to varying degrees depending on the numerator and denominator \
distributions. \nHowever the most useful thing out of Griffin is the idea of \
using the normal distribution approximation,  which might work well if the \
expected values are large.   A Poisson distribution with a rate as low as 10  \
looks very much like a normal distribution with mean and variance of 10. \n"
}], "Text",
 CellChangeTimes->{
  3.895731931598853*^9, {3.895739416382148*^9, 3.8957397106311274`*^9}, {
   3.8957409725114946`*^9, 3.8957411227708607`*^9}, {3.8957411709971795`*^9, 
   3.895741181424285*^9}, {3.895741251461441*^9, 3.8957415229452453`*^9}, {
   3.89574165610188*^9, 3.895741884431734*^9}, {3.8957419224223633`*^9, 
   3.895742004358389*^9}, {3.8957421090006056`*^9, 3.8957421167750683`*^9}, {
   3.895742991348387*^9, 3.8957430326060266`*^9}, {3.895743203440667*^9, 
   3.89574322787986*^9}, {3.895743625222623*^9, 3.8957436414271655`*^9}, {
   3.8957437890793023`*^9, 3.8957438301951666`*^9}, {3.8957463309739504`*^9, 
   3.895746371097906*^9}, {3.895757945388958*^9, 3.895757948530139*^9}, {
   3.8963438973566093`*^9, 3.896344046096691*^9}, {3.896362048345441*^9, 
   3.896362048968814*^9}, {3.9015328682361803`*^9, 
   3.901532896726898*^9}},ExpressionUUID->"3eaad458-bdf0-4ca4-a664-\
fff0eb984ffa"],

Cell[CellGroupData[{

Cell["The distribution of the ratio of two normal distributions", "Section",
 CellChangeTimes->{{3.896344050301335*^9, 
  3.8963440612457924`*^9}},ExpressionUUID->"5dd444c0-37be-4cf9-a037-\
8d1aec134f22"],

Cell[TextData[{
 "Started with   D\[IAcute]az-Franc\[EAcute]s, E. and F. J. Rubio (2013). \
\[OpenCurlyDoubleQuote]On the existence of a normal approximation to the \
distribution of the ratio of two independent normal random variables.\
\[CloseCurlyDoubleQuote] Statistical Papers 54: 309-323.\n\nThe main point of \
the paper is about when you can use a normal distribution to approximate that \
of the ratio of two normal distributions.  Apparently if the coefficient of \
variation for the denominator distribution is not large,  e.g. is less than \
1,  then the normal approximation of the ratio might be ok. \n\n\
D\[IAcute]az-Franc\[EAcute]s and Rubio also give an expression for the  \
density of the ratio of two normal distributions.   They say that, their \
results are only for the case when the coefficients of variation for the two \
variables ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", " ", "and", " ", "Y"}], TraditionalForm]],ExpressionUUID->
  "32ff553f-e9e6-4e5f-9248-d5341b950bcd"],
 " are less than 1.    i.s. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Delta]", "X"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", "x"], "/", 
      SubscriptBox["u", "X"]}], "<", "1"}]}], TraditionalForm]],
  ExpressionUUID->"54e434a7-b9b1-4375-bbe7-1f4c0faa6c7b"],
 "   and same for ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "a73b755f-9fc7-4976-b8db-abfb55e56506"],
 ".   In our case,where we will be using the a normal approximation to the \
Poisson distribution, which means that   ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "=", "u"}], TraditionalForm]],
  ExpressionUUID->"31888a1c-d8ff-42d3-9675-9015c7032621"],
 ".   So if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", ">", "1"}], TraditionalForm]],ExpressionUUID->
  "6145b6b2-59d6-4bf0-9f8e-7e0fc4897f8e"],
 " it will be the case that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sigma]", "<", "u"}], TraditionalForm]],ExpressionUUID->
  "43461cbb-0e13-456c-b190-28018698b1df"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Sigma]", "/", "u"}], "<", "1"}], TraditionalForm]],
  ExpressionUUID->"67ea199e-94a1-4eab-a870-2f284b1ba68f"],
 " .      So this math should apply in cases where the mean counts for both \
numerator and denominator are greater than 1. \n\nHad trouble getting the \
expression in (1) of  D\[IAcute]az-Franc\[EAcute]s and Rubio to work.   \n\
Then tried expression (1) in Kuethe DO, Caprihan A, Gach HM, Lowe IJ, \
Fukushima E. 2000. Imaging obstructed ventilation with NMR using inert \
fluorinated gases. Journal of applied physiology 88:2279-2286. \nThis uses \
the same basic parameterization as D\[IAcute]az-Franc\[EAcute]s and Rubio\n\
However the Kuethe et al expression gives different values than the \
D\[IAcute]az-Franc\[EAcute]s and Rubio.\nWhat\[CloseCurlyQuote]s more the \
Kuethe et al expression did not work as well for the LLR chi^2 check and the \
ROC performance chec, \n\n\n"
}], "Text",
 CellChangeTimes->{
  3.895731931598853*^9, {3.895739416382148*^9, 3.8957397106311274`*^9}, {
   3.8957409725114946`*^9, 3.8957411227708607`*^9}, {3.8957411709971795`*^9, 
   3.895741181424285*^9}, {3.895741251461441*^9, 3.8957415229452453`*^9}, {
   3.89574165610188*^9, 3.895741884431734*^9}, {3.8957419224223633`*^9, 
   3.895742004358389*^9}, {3.8957421090006056`*^9, 3.8957421167750683`*^9}, {
   3.895742991348387*^9, 3.8957430326060266`*^9}, {3.895743203440667*^9, 
   3.89574322787986*^9}, {3.895743625222623*^9, 3.8957436414271655`*^9}, {
   3.8957437890793023`*^9, 3.8957438301951666`*^9}, {3.8957463309739504`*^9, 
   3.895746371097906*^9}, {3.895757945388958*^9, 3.895757948530139*^9}, {
   3.8963438973566093`*^9, 3.8963441178228517`*^9}, {3.896347692345456*^9, 
   3.896347802458209*^9}, 3.8963478699150963`*^9, {3.8963479192916408`*^9, 
   3.896348153550815*^9}, 3.896348192006456*^9, {3.8963534710055633`*^9, 
   3.8963534731341476`*^9}, 3.901532047089054*^9, {3.9016119696854506`*^9, 
   3.901612132693858*^9}, {3.9016121896632624`*^9, 3.9016122490552235`*^9}, {
   3.9016123556704235`*^9, 3.9016123886740294`*^9}, {3.901613272784153*^9, 
   3.9016133330142727`*^9}, {3.9017082986210318`*^9, 
   3.9017083278101044`*^9}, {3.9017084279992723`*^9, 
   3.9017085103866453`*^9}, {3.9018963635770717`*^9, 
   3.901896437316143*^9}},ExpressionUUID->"64290bbb-d8b7-4dee-9eb1-\
8151d3898ea0"],

Cell[CellGroupData[{

Cell["D\[IAcute]az-Franc\[EAcute]s and Rubio  expression 1", "Subsubsection",
 CellChangeTimes->{{3.90189644371179*^9, 
  3.9018964476492815`*^9}},ExpressionUUID->"9c08d387-f583-4dc2-970f-\
bbdd948c013a"],

Cell[TextData[{
 "We have a normal density for ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "5691f5b8-7099-45f4-a26e-fa07c36cbec8"],
 " with mean ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "X"], TraditionalForm]],ExpressionUUID->
  "635fb5fd-9a4f-4873-a78c-87faebe23f43"],
 ", variance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "X"], "2"], TraditionalForm]],ExpressionUUID->
  "ede99641-79e1-4fa8-9239-5764cc3ceb50"],
 " and cv of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Delta]", "X"], "=", 
    RowBox[{
     SubscriptBox["\[Sigma]", "X"], "/", 
     SubscriptBox["u", "X"]}]}], TraditionalForm]],ExpressionUUID->
  "9090fc6e-b98d-42bb-8d33-cae9c54e51fe"],
 "  and similarly for ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "ece10376-52db-4b85-889a-0198bfa55a8f"],
 ", with mean ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "Y"], TraditionalForm]],ExpressionUUID->
  "ffc0ac05-19ed-4063-9c31-f79484b9370c"],
 ". variance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "Y"], "2"], TraditionalForm]],ExpressionUUID->
  "b885e0eb-db35-4333-876b-35673ad16711"],
 " and cv of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Delta]", "Y"], "=", 
    RowBox[{
     SubscriptBox["\[Sigma]", "y"], "/", 
     SubscriptBox["u", "Y"]}]}], TraditionalForm]],ExpressionUUID->
  "20109990-5fb6-43d0-8f98-b60830b12f17"],
 "\nThen there is a distribution for the ratio ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "/", "Y"}], TraditionalForm]],ExpressionUUID->
  "726bf9a4-c84b-438a-a0cc-ccb654d6f228"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "Z", ")"}], TraditionalForm]],ExpressionUUID->
  "e67ab34d-8311-42a2-9aba-33b2b6246c3d"],
 " where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", "=", 
    RowBox[{"X", "/", "Y"}]}], TraditionalForm]],ExpressionUUID->
  "76846c63-8ff5-44cc-bc15-f3ae0e2550a2"],
 ".\nWe will put the selected sites in the numerator, and the neutral sites \
in the denominator. \nThen the density of ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "d3918df4-384c-4456-96fe-56e143fd8ebc"],
 "  is given by a function,  ex (1) for  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     RowBox[{"z", ";", "\[Alpha]"}], ",", "\[Beta]", ",", "\[Gamma]"}], ")"}],
    TraditionalForm]],ExpressionUUID->"8748c436-1170-4e09-8cbc-f08d3fc1ff1e"],
 " \nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "=", 
    FractionBox[
     SubscriptBox["u", "X"], 
     SubscriptBox["u", "Y"]]}], TraditionalForm]],ExpressionUUID->
  "f0af0d99-0080-42f7-9c6f-45b620fe0fca"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    FractionBox[
     SubscriptBox["\[Sigma]", "Y"], 
     SubscriptBox["\[Sigma]", "X"]]}], TraditionalForm]],ExpressionUUID->
  "8b444908-9cda-4a05-8a8f-399da08e8728"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Delta]", "=", 
    FractionBox[
     SubscriptBox["\[Sigma]", "y"], 
     SubscriptBox["u", "Y"]]}], TraditionalForm]],ExpressionUUID->
  "09a46026-b8c0-4e58-b3f8-b59fdef08847"],
 "   \nBecause we are assuming that both ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", " ", "and", " ", "Y"}], TraditionalForm]],ExpressionUUID->
  "918df594-27bc-4682-8c21-08237d4d6125"],
 " are good approximations to Poisson variables,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "X"], "2"], "=", 
    SubscriptBox["u", "X"]}], TraditionalForm]],ExpressionUUID->
  "06a2d419-0900-4910-8a4a-34bb18777ee9"],
 " and so ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"X", " "}]], "=", " ", 
    SuperscriptBox[
     SubscriptBox["u", "X"], 
     RowBox[{"1", "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "a844e7f0-ab7d-460c-a800-5694dabcff8a"],
 " and similarly for ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "f47f1204-6681-41cd-b622-a92dc2d8ef1b"],
 "\nFrom the Poisson Random Field math,  the selected count (",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ")"}], TraditionalForm]],ExpressionUUID->
  "2bcb8d2f-aea8-44ee-8d52-3fac999da80c"],
 " for bin ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", " "}], TraditionalForm]],ExpressionUUID->
  "e24a043e-d023-425c-822f-3f396e575247"],
 "has ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "X"], TraditionalForm]],ExpressionUUID->
  "af8ddc37-4241-46ce-bcb3-b60f444c9a0e"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "X"], "2"], TraditionalForm]],ExpressionUUID->
  "3018df31-b12b-4ac3-98a8-f3fbdbe2bdf3"],
 " of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "S"], " ", 
    RowBox[{"\[ScriptCapitalF]", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"63eec99c-4435-462b-8b29-ff90fbbe6890"],
 "\nAnd the Neutral count (",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "7fb60e46-4b60-4c60-a675-687ceb9090c6"],
 ")  for bin ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", " "}], TraditionalForm]],ExpressionUUID->
  "629e69c9-f138-435a-9966-c7b23cac7205"],
 "has ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "Y"], TraditionalForm]],ExpressionUUID->
  "3ea9e62a-27e8-4568-86e6-fefa5eaae71e"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "Y"], "2"], TraditionalForm]],ExpressionUUID->
  "4645bc78-7c91-4216-acde-e92af79090f3"],
 " of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "N"], 
    RowBox[{"\[ScriptCapitalN]", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"66f280fb-12d6-45d7-b7af-1ecd4c4eacaa"],
 ".  \nIt follows then that \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "=", 
    FractionBox[
     RowBox[{
      SubscriptBox["\[Theta]", "S"], " ", 
      RowBox[{"\[ScriptCapitalF]", "(", 
       RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], 
     RowBox[{
      SubscriptBox["\[Theta]", "N"], 
      RowBox[{"\[ScriptCapitalN]", "(", 
       RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]]}], TraditionalForm]],
  ExpressionUUID->"441539b4-262d-46c2-b680-6c84f5310409"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Sigma]", "Y"], 
      SubscriptBox["\[Sigma]", "X"]], "=", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Theta]", "N"], 
          RowBox[{"\[ScriptCapitalN]", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
        RowBox[{"1", "/", "2"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox[
           RowBox[{"\[Theta]", " "}], 
           RowBox[{"S", " "}]], 
          RowBox[{"\[ScriptCapitalF]", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
        RowBox[{"1", "/", "2"}]]], "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{
            SubscriptBox["\[Theta]", "N"], 
            RowBox[{"\[ScriptCapitalN]", "(", 
             RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]}], 
          RowBox[{
           SubscriptBox["\[Theta]", 
            RowBox[{"S", " "}]], 
           RowBox[{"\[ScriptCapitalF]", "(", 
            RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], ")"}], 
        RowBox[{"1", "/", "2"}]], "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"\[Sqrt]", "\[Beta]"}]], "=", 
        SuperscriptBox["\[Beta]", 
         RowBox[{" ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"1a7b1d66-1685-40c2-b9c2-d3522aa4ed44"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Delta]", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox[
          RowBox[{"\[Theta]", " "}], "N"], 
         RowBox[{"\[ScriptCapitalN]", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{
       SubscriptBox["\[Theta]", "N"], " ", 
       RowBox[{"\[ScriptCapitalN]", "(", 
        RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Theta]", "N"], " ", 
          RowBox[{"\[ScriptCapitalN]", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}]}]], "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Theta]", "N"], " ", 
         RowBox[{"\[ScriptCapitalN]", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]]}]}]}], TraditionalForm]],
  ExpressionUUID->"9ffc2536-c748-492f-bc6d-3c337fad11b5"],
 "\nthen ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{
      RowBox[{"z", ",", "\[Beta]"}], "\[InvisibleComma]", 
      RowBox[{",", "\[Delta]"}]}], ")"}], ":=", "  ", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"1", "+", "\[Beta]"}], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Delta]", "2"]}]]}]], 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox["z", "2"], "\[Beta]"]}], ")"}], " ", 
       SqrtBox["\[Beta]"]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}], "2"], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              FractionBox[
               SuperscriptBox["z", "2"], "\[Beta]"]}], ")"}], " ", 
            SuperscriptBox["\[Delta]", "2"]}]]], " ", 
         SqrtBox[
          FractionBox["\[Pi]", "2"]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}], " ", 
         RowBox[{"Erf", "[", 
          FractionBox[
           RowBox[{"1", "+", "z"}], 
           RowBox[{
            SqrtBox["2"], " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              FractionBox[
               SuperscriptBox["z", "2"], "\[Beta]"]}]], " ", "\[Delta]"}]], 
          "]"}]}], 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "+", 
           FractionBox[
            SuperscriptBox["z", "2"], "\[Beta]"]}]], " ", "\[Delta]"}]]}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "974360e7-bf99-4ae8-8646-be77e9921d00"],
 "\nBy playing around with some 3D plots,  \[Beta]  act mostly like the mean \
of the density, while \[Delta] works like a variance .  When \[Beta] > 10 the \
density gets weird shapes. "
}], "Text",
 CellChangeTimes->{{3.901896452925785*^9, 3.901896530753694*^9}, {
  3.901896579086481*^9, 3.901896714167717*^9}, {3.901896901863333*^9, 
  3.9018969044724493`*^9}, {3.901896941248477*^9, 3.901897009969146*^9}, {
  3.9070583387181225`*^9, 
  3.907058360729662*^9}},ExpressionUUID->"ebdfd726-b28e-4ffb-b120-\
aeb19c32009e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kuethe et al expression 1", "Subsubsection",
 CellChangeTimes->{{3.9018964569838395`*^9, 
  3.901896466213123*^9}},ExpressionUUID->"6a33470c-bf48-46c2-9fef-\
ddc95646d95a"],

Cell[TextData[{
 "So we have a normal density for ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],ExpressionUUID->
  "521c46ea-300d-411a-8a40-b06e90d3c012"],
 " with mean ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "X"], TraditionalForm]],ExpressionUUID->
  "ca5e8f08-47ed-49e3-964b-9d049475157a"],
 ", variance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "X"], "2"], TraditionalForm]],ExpressionUUID->
  "6cc3bd0d-a0f1-4fdb-bd0c-8ba7e06127cd"],
 " and cv of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Delta]", "X"], "=", 
    RowBox[{
     SubscriptBox["\[Sigma]", "X"], "/", 
     SubscriptBox["u", "X"]}]}], TraditionalForm]],ExpressionUUID->
  "e7c7dfde-4a28-4c40-a24e-0dc471adef1d"],
 "  and similarly for ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "1c1d4db1-243a-4f9e-8d32-a4963071864e"],
 ", with mean ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "Y"], TraditionalForm]],ExpressionUUID->
  "574fcfe4-4e8f-4a65-8705-391314f605c7"],
 ". variance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "Y"], "2"], TraditionalForm]],ExpressionUUID->
  "893245cd-4640-47f4-8735-0bf181de12db"],
 " and cv of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Delta]", "Y"], "=", 
    RowBox[{
     SubscriptBox["\[Sigma]", "y"], "/", 
     SubscriptBox["u", "Y"]}]}], TraditionalForm]],ExpressionUUID->
  "f1c1501d-dd07-46b1-9863-ec1d0d3c6152"],
 "  \[Tau]\nThen there is a distribution for the ratio ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", "/", "Y"}], TraditionalForm]],ExpressionUUID->
  "feadd6ae-1712-4a4b-a41f-8734001a5f84"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "Z", ")"}], TraditionalForm]],ExpressionUUID->
  "a40dd7c0-895b-4c7c-912a-ae329c6fdbd0"],
 " where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", "=", 
    RowBox[{"X", "/", "Y"}]}], TraditionalForm]],ExpressionUUID->
  "d123ab3a-5c3f-43ee-b4c8-7c7e466a4611"],
 ".\nWe will put the selected sites in the numerator, and the neutral sites \
in the denominator. \nThen the density of ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "b95ad5c4-530d-475d-9aa4-ac3ba7c4e169"],
 "  is given by a function,  ex (1) for  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["h", "Z"], "(", 
    RowBox[{
     RowBox[{"z", ";", "\[Alpha]"}], ",", "\[Beta]", ",", "\[Gamma]"}], ")"}],
    TraditionalForm]],ExpressionUUID->"036a5b11-03c3-42d7-a4ae-8b9abcabec06"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "=", 
    FractionBox[
     SubscriptBox["u", "X"], 
     SubscriptBox["u", "Y"]]}], TraditionalForm]],ExpressionUUID->
  "4274c05d-a0fa-4925-a7b0-fd50d2235478"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]", "=", 
    FractionBox[
     SubscriptBox["\[Sigma]", "Y"], 
     SubscriptBox["\[Sigma]", "X"]]}], TraditionalForm]],ExpressionUUID->
  "2424a49d-39db-4230-a42a-8133e2cb2f4a"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "=", 
    FractionBox[
     SubscriptBox["\[Sigma]", "y"], 
     SubscriptBox["u", "Y"]]}], TraditionalForm]],ExpressionUUID->
  "f020d92c-754e-4a1b-936e-8535a43c75bb"],
 "   (the coefficient of variation for ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "5fe1fe50-e2ac-48f0-9456-4671c7f82302"],
 ") (*note we use \[Tau] here, while the paper uses \[Gamma], but we are \
already using  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Gamma]", "=", 
    RowBox[{"2", "N", " ", "s"}]}], TraditionalForm]],ExpressionUUID->
  "f237f436-b196-4369-80ee-2fbca9783377"],
 " to we use \[Tau] instead,  which ends up going away*)\nBecause we are \
assuming that both ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", " ", "and", " ", "Y"}], TraditionalForm]],ExpressionUUID->
  "57d1a03c-164e-4370-92b5-9f89d3e53aa6"],
 " are good approximations to Poisson variables,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "X"], "2"], "=", 
    SubscriptBox["u", "X"]}], TraditionalForm]],ExpressionUUID->
  "35147da6-a27c-4b15-91c9-443a0e8b427e"],
 " and so ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"X", " "}]], "=", " ", 
    SuperscriptBox[
     SubscriptBox["u", "X"], 
     RowBox[{"1", "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "77831cbb-cff1-4470-9879-7ff6124552e9"],
 " and similarly for ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "a042b36f-4228-457b-aa89-255e07a408e2"],
 "\nFrom the Poisson Random Field math,  the selected count (",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ")"}], TraditionalForm]],ExpressionUUID->
  "0705e787-6fd0-4d2b-81b2-5465ac0c4705"],
 " for bin ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", " "}], TraditionalForm]],ExpressionUUID->
  "6081f10d-97f8-4ce0-a015-94c6eb5dd7f1"],
 "has ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "X"], TraditionalForm]],ExpressionUUID->
  "f53fc1f9-136c-40e7-898f-51882f8fa3f8"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "X"], "2"], TraditionalForm]],ExpressionUUID->
  "64bfbd7c-10ea-4c27-83f4-480f85425eed"],
 " of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "S"], " ", 
    RowBox[{"\[ScriptCapitalF]", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"4730a40e-7244-4cdf-a31a-a4b57bab8128"],
 "\nAnd the Neutral count (",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],ExpressionUUID->
  "2321c737-a7ed-487c-952d-8807a340cb17"],
 ")  for bin ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", " "}], TraditionalForm]],ExpressionUUID->
  "ee133d9f-f638-48d1-af86-d45537d809aa"],
 "has ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "Y"], TraditionalForm]],ExpressionUUID->
  "2d4139f2-9fc1-48bd-a777-ab0ff64d1034"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Sigma]", "Y"], "2"], TraditionalForm]],ExpressionUUID->
  "cb3b3a34-8269-4167-bf11-1c87168a2efd"],
 " of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "N"], 
    RowBox[{"\[ScriptCapitalN]", "(", 
     RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"6c6e3096-be2d-4b5b-abee-fa028d73cfe2"],
 ".  \nIt follows then that \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "=", 
    FractionBox[
     RowBox[{
      SubscriptBox["\[Theta]", "S"], " ", 
      RowBox[{"\[ScriptCapitalF]", "(", 
       RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], 
     RowBox[{
      SubscriptBox["\[Theta]", "N"], 
      RowBox[{"\[ScriptCapitalN]", "(", 
       RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]]}], TraditionalForm]],
  ExpressionUUID->"be181d29-02f2-422c-86ed-6df6b9d790ba"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]", "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Sigma]", "Y"], 
      SubscriptBox["\[Sigma]", "X"]], "=", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Theta]", "N"], 
          RowBox[{"\[ScriptCapitalN]", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
        RowBox[{"1", "/", "2"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox[
           RowBox[{"\[Theta]", " "}], 
           RowBox[{"S", " "}]], 
          RowBox[{"\[ScriptCapitalF]", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
        RowBox[{"1", "/", "2"}]]], "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{
            SubscriptBox["\[Theta]", "N"], 
            RowBox[{"\[ScriptCapitalN]", "(", 
             RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]}], 
          RowBox[{
           SubscriptBox["\[Theta]", 
            RowBox[{"S", " "}]], 
           RowBox[{"\[ScriptCapitalF]", "(", 
            RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], ")"}], 
        RowBox[{"1", "/", "2"}]], "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"\[Sqrt]", "\[Alpha]"}]], "=", 
        SuperscriptBox["\[Alpha]", 
         RowBox[{" ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"04aac4b2-9648-46c2-a7a2-4ef3deda1203"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox[
          RowBox[{"\[Theta]", " "}], "N"], 
         RowBox[{"\[ScriptCapitalN]", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{
       SubscriptBox["\[Theta]", "N"], " ", 
       RowBox[{"\[ScriptCapitalN]", "(", 
        RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Theta]", "N"], " ", 
          RowBox[{"\[ScriptCapitalN]", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}]}]], "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Theta]", "N"], " ", 
         RowBox[{"\[ScriptCapitalN]", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]]}]}]}], TraditionalForm]],
  ExpressionUUID->"6301056c-e503-4b4c-98da-be8379337495"],
 "\n\nThese just get plugged into expression (1) of the paper,  i.e.\nThen ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["h", "Z"], "(", 
     RowBox[{
      RowBox[{"z", ";", "\[Alpha]"}], ",", "\[Beta]", ",", "\[Tau]"}], ")"}], 
    "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[Alpha]", "2"], 
            SuperscriptBox["\[Tau]", "2"]}]}], 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Beta]", "2"]}]], ")"}]}]], 
      FractionBox["\[Tau]", 
       RowBox[{"\[Pi]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[Tau]", "2"], 
           SuperscriptBox["z", "2"]}]}], ")"}]}]]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Tau]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Alpha]", " ", 
           SuperscriptBox["\[Tau]", "2"], "z"}]}], ")"}]}], 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            SuperscriptBox["\[Tau]", "2"], " ", 
            SuperscriptBox["z", "2"]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", " ", "\[Pi]"}], ")"}], 
         RowBox[{"1", "/", "2"}]]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Tau]", "2"], "(", 
            RowBox[{"z", "-", "\[Alpha]"}], ")"}], "2"], 
          RowBox[{"2", " ", 
           RowBox[{
            SuperscriptBox["\[Beta]", "2"], "(", 
            RowBox[{"1", "+", 
             RowBox[{
              SuperscriptBox["\[Tau]", "2"], " ", 
              SuperscriptBox["z", "2"]}]}], ")"}], " "}]], ")"}]}]], 
      RowBox[{"Erf", "[", 
       FractionBox[
        RowBox[{"1", "+", 
         RowBox[{"\[Alpha]", " ", 
          SuperscriptBox["\[Tau]", "2"], " ", "z"}]}], 
        RowBox[{"\[Beta]", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["\[Tau]", "2"], " ", 
               SuperscriptBox["z", "2"]}]}], ")"}]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}]], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"04f5f30d-f480-44b8-923a-f24c9c3a3728"],
 "\nBecause ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]", "=", 
    RowBox[{"1", "/", 
     SuperscriptBox["\[Alpha]", 
      RowBox[{"1", "/", "2"}]]}]}], TraditionalForm]],ExpressionUUID->
  "e61ae852-098d-4545-825f-978191a1636f"],
 " we can simplify to get rid of \[Tau] and we get \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["h", "Z"], "(", 
     RowBox[{
      RowBox[{"z", ";", "\[Alpha]"}], ",", "\[Beta]"}], ")"}], ":=", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"1", "+", "\[Alpha]"}], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Beta]", "2"]}]]}]], 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox["z", "2"], "\[Alpha]"]}], ")"}], " ", 
       SqrtBox["\[Alpha]"]}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z", "-", "\[Alpha]"}], ")"}], "2"], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             FractionBox[
              SuperscriptBox["z", "2"], "\[Alpha]"]}], ")"}], " ", 
           SuperscriptBox["\[Alpha]", "2"], " ", 
           SuperscriptBox["\[Beta]", "2"]}]]}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}], " ", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"1", "+", "z"}], 
         RowBox[{
          SqrtBox["2"], " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox["z", "2"], "\[Alpha]"]}]], " ", "\[Beta]"}]], 
        "]"}]}], 
      RowBox[{
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          FractionBox[
           SuperscriptBox["z", "2"], "\[Alpha]"]}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       SqrtBox["\[Alpha]"], " ", "\[Beta]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"57b50e14-b43d-429c-b7c8-64c34a6a1b9d"],
 "\nIf ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "<", "10", " "}], TraditionalForm]],ExpressionUUID->
  "73f67fc1-5e96-4e19-a246-6da0978b7b33"],
 " or so it works mostly like the mean of the density, while \[Beta] works \
like a variance .  When \[Alpha] > 10 the density gets weird shapes. "
}], "Text",
 CellChangeTimes->{{3.900508137083295*^9, 3.9005082820309525`*^9}, {
   3.9012068935332856`*^9, 3.9012069025823727`*^9}, {3.901208056501932*^9, 
   3.901208139260768*^9}, {3.9012081740395637`*^9, 3.90120825365621*^9}, {
   3.9012672742794547`*^9, 3.9012673437870784`*^9}, {3.9012674277749767`*^9, 
   3.901267489518252*^9}, {3.9012675394180174`*^9, 3.901267544393552*^9}, {
   3.9015318016464844`*^9, 3.901531817750068*^9}, {3.901532218240448*^9, 
   3.901532218240448*^9}, {3.901532660126169*^9, 3.9015326649627967`*^9}, {
   3.901610518674389*^9, 3.90161056303356*^9}, {3.9016107536096544`*^9, 
   3.9016108378012276`*^9}, {3.901610955268339*^9, 3.901611045369502*^9}, {
   3.9016112293469152`*^9, 3.9016112293479156`*^9}, {3.901613371610544*^9, 
   3.901613372851812*^9}, {3.901613407500315*^9, 3.901613427067749*^9}, {
   3.901613469481346*^9, 3.901613488591425*^9}, {3.9016135493429685`*^9, 
   3.9016138291749425`*^9}, {3.9016138636753473`*^9, 3.901613924870048*^9}, {
   3.9016140358313904`*^9, 3.90161406105271*^9}, {3.9016141174621544`*^9, 
   3.901614465059369*^9}, {3.9016145208691945`*^9, 3.901614540965436*^9}, {
   3.901614631303358*^9, 3.901614631933855*^9}, {3.901615491399294*^9, 
   3.901615500567792*^9}, {3.901615642943017*^9, 3.901615642944019*^9}, {
   3.9016158766537056`*^9, 3.901615909955372*^9}, {3.9016160783189025`*^9, 
   3.901616084660616*^9}, {3.9016162850912066`*^9, 3.901616325638033*^9}, {
   3.901616484867829*^9, 3.9016164948929777`*^9}, {3.901617149007777*^9, 
   3.9016172473486185`*^9}, {3.9016172808054996`*^9, 3.901617344420291*^9}, {
   3.9016181551345387`*^9, 3.901618168491273*^9}, {3.9016182720354176`*^9, 
   3.9016182761278715`*^9}, {3.9016184761545005`*^9, 
   3.9016184968049545`*^9}, {3.9016185296326756`*^9, 3.901618616119327*^9}, {
   3.901618692359868*^9, 3.9016189403338537`*^9}, {3.901619008386965*^9, 
   3.901619011043503*^9}, {3.901619073214245*^9, 3.9016191978303347`*^9}, {
   3.901619344812951*^9, 3.90161935183158*^9}, {3.90163360430888*^9, 
   3.9016336269651527`*^9}, {3.901634695913784*^9, 3.9016346959147816`*^9}, {
   3.901634847412407*^9, 3.9016348868536005`*^9}, {3.9016350853743153`*^9, 
   3.9016350978872447`*^9}, {3.901635152425655*^9, 3.9016351539452868`*^9}, 
   3.901708547189497*^9, {3.9017085939843507`*^9, 3.901708709384462*^9}, {
   3.9017087657246375`*^9, 3.9017087693928466`*^9}, {3.901708804873056*^9, 
   3.9017088575653315`*^9}, {3.9017089411855516`*^9, 
   3.9017089534337397`*^9}, {3.9017186985393815`*^9, 
   3.9017187215936737`*^9}, {3.901718862329668*^9, 3.901718870307765*^9}, {
   3.9017189612332973`*^9, 3.9017189803289814`*^9}, {3.901720266848261*^9, 
   3.9017203607548313`*^9}, {3.9017906501161537`*^9, 
   3.9017906838599887`*^9}, {3.9018967322686796`*^9, 
   3.9018968880642843`*^9}},ExpressionUUID->"f9aaf946-8ed0-45d5-9bdb-\
1c50efd447dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["How many unknowns can we handle? ", "Subsubsection",
 CellChangeTimes->{{3.9017195245995054`*^9, 3.9017195318541317`*^9}, 
   3.9017196059044056`*^9},ExpressionUUID->"daaf6f84-4e28-4247-aebd-\
53e5f44353fb"],

Cell[TextData[{
 "If we have both a neutral and a selected SFS and we work with a density \
that has ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "f3d45544-f5b0-4a32-a0d2-20cc89df35dd"],
 " unknown,  then there will be ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "+", "2"}], TraditionalForm]],ExpressionUUID->
  "c698e105-3785-43d4-9756-2d574ee6f56b"],
 " unknowns,  i.e. those for the density plus ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "N"], TraditionalForm]],ExpressionUUID->
  "f7ff664e-4db8-466e-a27c-cb48b3267a67"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "S"], TraditionalForm]],ExpressionUUID->
  "a91a5e99-705e-40be-8ad4-45e5beac0458"],
 ".  \nIn playing around with the estimation of all four,  it appears that we \
cannot estimate them all.  \n"
}], "Text",
 CellChangeTimes->{{3.9017195368046975`*^9, 3.9017196341909027`*^9}, 
   3.9017197005364923`*^9},ExpressionUUID->"e615844e-fbb7-403b-aa7c-\
f697952fc066"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Estimating ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "N"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bdb24bd8-2a80-42c7-abb6-2523c836c6c0"],
 " separately"
}], "Subsubsection",
 CellChangeTimes->{{3.9017197145464735`*^9, 
  3.901719721712651*^9}},ExpressionUUID->"2499ba42-b1e8-4680-ab7a-\
b2d6c479f125"],

Cell[TextData[{
 "The ratio density depends on ",
 Cell[BoxData[
  FormBox["\[Alpha]", TraditionalForm]],ExpressionUUID->
  "09771c96-2ce0-4b8e-b2a1-de2ef8930ee7"],
 ", which is the ratio ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     SubscriptBox["\[Theta]", "S"], " ", 
     RowBox[{"\[ScriptCapitalF]", "(", 
      RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], 
    RowBox[{
     SubscriptBox["\[Theta]", "N"], 
     RowBox[{"\[ScriptCapitalN]", "(", 
      RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], TraditionalForm]],
  ExpressionUUID->"cc994efe-3b3e-4901-a356-9fa326e50f08"],
 " which is the ratio of expected counts in bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "f735940e-4afd-4b28-84cd-dac4408b3f14"],
 " and is close to the expectation of the density of the ratio when \[Alpha] \
is not very large.  This ratio is appropriate as the effective population \
size component,  which is the same for selected and neutral snp counts,  \
cancels out.  \n\nThe ratio also depends on ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "=", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", "N"], " ", 
       RowBox[{"\[ScriptCapitalN]", "(", 
        RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "07e64916-02d4-4574-b20c-1786689b59e5"],
 " which obviously is a function of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "N"], TraditionalForm]],ExpressionUUID->
  "46e0fd59-d1ab-4440-a3cb-1453138937b0"],
 " and mostly influences the variance of density. \nSuppose we just use \
Watterson\[CloseCurlyQuote]s estimator of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "N"], TraditionalForm]],ExpressionUUID->
  "046a1c44-66f9-44cf-b85d-a6e389fb9a14"],
 " and don\[CloseCurlyQuote]t try to estimate it from the likelihood. \nThis \
will partly violate the use of the ratio,  which we are using because we want \
to be able to ignore demography and it is demography that determines the \
effective population size, and thus shapes both ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "S"], TraditionalForm]],ExpressionUUID->
  "bf8c8e1e-d482-48db-ad9f-94aba6c9605f"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "N"], TraditionalForm]],ExpressionUUID->
  "c02f02dd-4968-4090-9291-2186fe65826b"],
 ".  But if \[Beta] mostly shapes the variance of the density,  then perhaps \
it does not matter much if Watterson\[CloseCurlyQuote]s estimator is not \
correct.  If so then we can use this value as a mean\[CloseCurlyQuote]s to \
estimator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "S"], TraditionalForm]],ExpressionUUID->
  "776e199e-8805-4087-ba93-849ed6d82bf8"],
 " as well as the terms of the density of \[Gamma] ."
}], "Text",
 CellChangeTimes->{{3.901719729249113*^9, 
  3.9017202094536304`*^9}},ExpressionUUID->"507e9054-d9c6-4e3e-92d2-\
a91dcb3acb8b"],

Cell[TextData[{
 "Another way to build in an estimate of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "N"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b5e628c0-dd39-4d61-8f70-da45dc6306a1"],
 " is to generate one on the fly as a function of the ratio of SNP counts and \
the current value of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "S"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0172ca2c-5246-4934-9274-3fc19feed6fd"],
 ".  \nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      SubscriptBox[
       OverscriptBox["\[Theta]", "^"], "N"], "=", 
      RowBox[{
       UnderscriptBox["\[Sum]", "i"], 
       RowBox[{"1", "/", "i"}]}]}], 
     RowBox[{
      SubscriptBox[
       OverscriptBox["\[Theta]", "^"], "S"], " ", 
      RowBox[{
       UnderscriptBox["\[Sum]", "i"], 
       RowBox[{"\[ScriptCapitalF]", "(", 
        RowBox[{
         RowBox[{"n", "-"}], ",", "i"}], ")"}]}]}]], "=", " ", 
    FractionBox[
     RowBox[{
      UnderscriptBox["\[Sum]", "i"], 
      RowBox[{
       SubscriptBox["SFS", "N"], "(", "i", ")"}]}], 
     RowBox[{
      UnderscriptBox["\[Sum]", "i"], 
      RowBox[{
       SubscriptBox["SFS", "S"], "(", "i", ")"}]}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0dacb2b2-266f-4eb9-96d3-65cbe55b3290"],
 "  ,   Let our estimate be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Theta]", "^"], "N"], "=", 
    RowBox[{"\[Kappa]", " ", 
     SubscriptBox[
      OverscriptBox["\[Theta]", "^"], "S"], 
     FractionBox[
      RowBox[{" ", 
       RowBox[{
        UnderscriptBox["\[Sum]", "i"], 
        RowBox[{"\[ScriptCapitalF]", "(", 
         RowBox[{
          RowBox[{"n", "-"}], ",", "i"}], ")"}]}]}], 
      RowBox[{
       UnderscriptBox["\[Sum]", "i"], 
       RowBox[{"1", "/", "i"}]}]]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "84caa0f7-5393-4e4c-b28d-afa00c4fb553"],
 "  where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Kappa]", "=", 
    FractionBox[
     RowBox[{
      UnderscriptBox["\[Sum]", "i"], 
      RowBox[{
       SubscriptBox["SFS", "N"], "(", "i", ")"}]}], 
     RowBox[{
      UnderscriptBox["\[Sum]", "i"], 
      RowBox[{
       SubscriptBox["SFS", "S"], "(", "i", ")"}]}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a86bf1a0-14c3-45e2-a9de-7ac9821487e2"],
 " is the ratio of counts from the data\nSo while optimizing, and finding the \
",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "S"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "112ff16b-e71a-4d14-b64b-ee237bc87574"],
 " that maximizes the likelihood,  we could determine ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[Theta]", "^"], "N"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7b2bacc7-d29d-4c07-9fa4-8715e61dfdd9"],
 " for each value of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "S"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d3b10bc7-3a9a-4e43-91b3-6d2bfcced12b"],
 " on the fly during the optimization. "
}], "Text",
 CellChangeTimes->{{3.9019027807372713`*^9, 
  3.901903239871396*^9}},ExpressionUUID->"5e546f93-b145-446f-9ccc-\
e5d6976e86e2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing things", "Chapter",
 CellChangeTimes->{{3.8961971650457273`*^9, 3.8961971663663464`*^9}, {
  3.896345160939417*^9, 
  3.8963451635484486`*^9}},ExpressionUUID->"9d52be41-29f5-4e5e-9d99-\
db2a8bfd7ec8"],

Cell["\<\
A set of python scripts were written.   They all import SFS_functions.py,  \
which contains a set of functions for generating data sets and calculation \
likelihoods. \
\>", "Text",
 CellChangeTimes->{{3.8963575782189217`*^9, 
  3.8963576327323036`*^9}},ExpressionUUID->"dc94894b-ad39-45ba-84e5-\
07bfaf299252"],

Cell[CellGroupData[{

Cell["sim_ratio_poissons_with_normal_approximation.py", "Section",
 CellChangeTimes->{
  3.8963469338894978`*^9},ExpressionUUID->"47fe2c84-e688-41a6-af74-\
0fa8492b4fa4"],

Cell[TextData[{
 "Script for checking out the use of the ratio of normal distributions. It \
generates a plot of simulated distributions including the ratio of Poissons \
together with ratio of normals (ex (1) for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "Z"], "(", 
    RowBox[{
     RowBox[{"z", ";", "\[Beta]"}], ",", "\[Rho]", ",", 
     SubscriptBox["\[Delta]", "Y"]}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1939edf6-225f-419c-bf41-ab47755379a1"],
 " as  given by D\[IAcute]az-Franc\[EAcute]s and Rubio) and normal \
approximation to ratio of normals as  given by D\[IAcute]az-Franc\[EAcute]s \
and Rubio.  Ideally the distribution of the ratio of actual Poisson random \
variables should be similar to the ratio of a normal distributions with the \
same mean and variance. "
}], "Text",
 CellChangeTimes->{{3.8963458030113816`*^9, 3.896345847300459*^9}, {
  3.896346938401097*^9, 3.8963469503202524`*^9}, {3.8963470275859823`*^9, 
  3.8963470689782352`*^9}, {3.8963535218548126`*^9, 
  3.896353540925867*^9}},ExpressionUUID->"42713337-ca24-4e55-b2e5-\
2646b4a9c314"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SFS_LLRtest.py", "Section",
 CellChangeTimes->{{3.8963469680351763`*^9, 3.8963469699055104`*^9}, {
  3.8963569071432295`*^9, 
  3.896356909382576*^9}},ExpressionUUID->"d2c322ca-db77-441d-8703-\
fe74e6457d16"],

Cell[TextData[{
 "A script for checking the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Chi]", "2"], TraditionalForm]],ExpressionUUID->
  "6a14c746-040a-4945-a190-5b251d7a5cab"],
 " approximation of the LLR statistic with 1 degree of freedom .\n\nThe basic \
PRF model (which assumes a Fisher Wright population) gives us a way to \
calculate the probability for a data set  under both a model with selection \
and a model without. \n\nWith selection there will be two parameters,  \
\[Theta] and \[Gamma] (i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", " ", "N", " ", "u"}], TraditionalForm]],ExpressionUUID->
  "31e1867b-a281-4255-ad63-6a27011f3bcb"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", " ", "s"}], TraditionalForm]],ExpressionUUID->
  "ab1afdff-9704-4308-a499-11cf2fccb7bb"],
 ").  \nThe data will be a single SFS,  either unfolded or folded. \nThe \
probability of a data set with selection will be \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"L", "(", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{"\[Gamma]", "|", "X"}]}], ")"}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "-", "1"}]], 
     FractionBox[
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[Theta]"}], " ", 
          RowBox[{"F", "(", 
           RowBox[{"i", ",", "\[Gamma]"}], ")"}]}]], "(", 
        RowBox[{"\[Theta]", " ", 
         RowBox[{"F", "(", 
          RowBox[{"i", ",", "\[Gamma]"}], ")"}]}], ")"}], 
       SubscriptBox["x", "i"]], 
      RowBox[{
       SubscriptBox["x", "i"], "!"}]]}]}], TraditionalForm]],ExpressionUUID->
  "460ab2d5-8e4f-4453-b8ca-0314f0c70bfc"],
 " for the unfolded and \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"L", "(", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{"\[Gamma]", "|", "X"}]}], ")"}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "/", "2"}]], 
     FractionBox[
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[Theta]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"F", "(", 
             RowBox[{"i", ",", "\[Gamma]"}], ")"}], "+", 
            RowBox[{"F", "(", 
             RowBox[{
              RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}]}], ")"}]}]], 
        "(", 
        RowBox[{"\[Theta]", "  ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"F", "(", 
            RowBox[{"i", ",", "\[Gamma]"}], ")"}], "+", 
           RowBox[{"F", "(", 
            RowBox[{
             RowBox[{"n", "-", "i"}], ",", "\[Gamma]"}], ")"}]}], ")"}]}], 
        ")"}], 
       SubscriptBox["x", "i"]], 
      RowBox[{
       SubscriptBox["x", "i"], "!"}]]}]}], TraditionalForm]],ExpressionUUID->
  "9bb39123-eabb-428f-93eb-9b0cd00f2e61"],
 " for the folded\n\nThe probability without selection  will be \n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"L", "(", 
     RowBox[{"\[Theta]", "|", "X"}], ")"}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "-", "1"}]], 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "\[Theta]"}], " "}], "i"]], "(", 
         FractionBox["\[Theta]", "i"], " ", ")"}], 
        SubscriptBox["x", "i"]], 
       RowBox[{
        SubscriptBox["x", "i"], "!"}]], "for", " ", "the", " ", "unfolded", 
      " ", "and"}]}]}], TraditionalForm], "\n", 
  FormBox[
   RowBox[{
    RowBox[{"L", "(", 
     RowBox[{"\[Theta]", "|", "X"}], ")"}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"n", "/", "2"}]], 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Theta]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "i"], "+", 
             FractionBox["1", 
              RowBox[{"n", "-", "i"}]]}], ")"}]}]], "(", 
         RowBox[{"\[Theta]", "  ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "i"], "+", 
            FractionBox["1", 
             RowBox[{"n", "-", "i"}]]}], ")"}]}], ")"}], 
        SubscriptBox["x", "i"]], 
       RowBox[{
        SubscriptBox["x", "i"], "!"}]], "for", " ", "the", " ", 
      "folded"}]}]}], TraditionalForm]}],ExpressionUUID->
  "e6e08095-be39-4a28-b6a1-89410a3a3d31"],
 "\n"
}], "Text",
 CellChangeTimes->{{3.8963469740165243`*^9, 3.8963470064014664`*^9}, {
  3.896347110317363*^9, 3.896347114931554*^9}, {3.896353905411*^9, 
  3.896353940402461*^9}},ExpressionUUID->"99dafc6f-9049-4a50-8c34-\
0a5639d666e3"],

Cell[TextData[{
 "Then if we maximize the log of both functions,  yielded ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Ln", "max"], "(", 
    RowBox[{"L", "(", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{"\[Gamma]", "|", "X"}]}], ")"}], ")"}], TraditionalForm]],
  ExpressionUUID->"7110f247-fb49-4353-b14a-437b05837dc6"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Ln", "max"], "(", 
    RowBox[{"L", "(", 
     RowBox[{"\[Theta]", "|", "X"}], ")"}], ")"}], TraditionalForm]],
  ExpressionUUID->"1f831c3b-846f-43af-82f2-726d11f5748d"],
 " \nWe can calculate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "=", " ", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[Times]", " ", 
     FractionBox[
      FormBox[
       RowBox[{
        SubscriptBox["Ln", "max"], "(", 
        RowBox[{"L", "(", 
         RowBox[{"\[Theta]", ",", 
          RowBox[{"\[Gamma]", "|", "X"}]}], ")"}], ")"}],
       TraditionalForm], 
      RowBox[{" ", 
       FormBox[
        RowBox[{
         SubscriptBox["Ln", "max"], "(", 
         RowBox[{"L", "(", 
          RowBox[{"\[Theta]", "|", "X"}], ")"}], ")"}],
        TraditionalForm]}]]}]}], TraditionalForm]],ExpressionUUID->
  "df40162d-77e9-467f-813f-974e1d4f473f"],
 " , which should be distributed as a ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Chi]", "1"], "2"], TraditionalForm]],ExpressionUUID->
  "435002d4-84c4-49cd-89cd-96fdc370d8aa"],
 " distribution \nIn the case of a using the ratio,  the data ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4a667540-79a4-4df0-a289-6a693ee09167"],
 " is a set of ratios,  one for each SFS bin.   So unlike the basic PRF model \
we simulate two SFS and then generate the ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d1ec66df-1bdb-45c8-8cc6-23ee74503a75"],
 " array by taking,  where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "52d0ac8f-87f7-4f38-b306-f47c0fc1360d"],
 " is the ratio of the SSFS bin ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", " "}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "375eab3f-f1fa-4dc2-ba53-89b70a71fe7c"],
 "count to the NSFS bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2826511f-b3e3-48b4-be24-cc17121a7816"],
 " count. \nIf the NSFS bin ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e1f08b44-6a42-49c2-b47c-cd96d6b08f69"],
 " count is zero,  just skip that bin and do not include it in the \
calculation of \[CapitalDelta] \n"
}], "Text",
 CellChangeTimes->{{3.896347125810192*^9, 3.8963471890918655`*^9}, {
  3.896353942708808*^9, 
  3.896354064721401*^9}},ExpressionUUID->"4e9a6240-70cb-4ed7-a62f-\
10d669838653"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SFS_ROC.py", "Section",
 CellChangeTimes->{{3.8963552763145957`*^9, 
  3.896355278475075*^9}},ExpressionUUID->"e0b15fc6-e298-467a-b61f-\
705358e5adc8"],

Cell["\<\
This script generates ROC curves to look at the overall discriminatory \
ability of the likelihood ratio tests.   An ROC curve plots the true positive \
rate (as a function of threshold value - e.g. a cutoff \[OpenCurlyQuote]p\
\[CloseCurlyQuote] value)  against the false positive rate.  They are useful \
to determine the overall discriminatory ability of a particular kind of \
hypothesis test. 

This script generates ROC curves for the basic likelihood ratio test of \
selection for the PRF model under Fisher Wright,  and for a likelihood ratio \
test of selection based on SFS ratios.  
ROC curves are generated for either or both models.  Use sets the \[Theta] \
value to be used. 

\
\>", "Text",
 CellChangeTimes->{{3.896355283259555*^9, 3.8963558264154873`*^9}, {
  3.896355868239767*^9, 3.8963558813115587`*^9}, {3.8963559175198936`*^9, 
  3.896356508468404*^9}, {3.8963565442329617`*^9, 3.8963565543735375`*^9}, {
  3.8963566553495054`*^9, 3.8963567440058746`*^9}, {3.8963568156385565`*^9, 
  3.8963568398297377`*^9}},ExpressionUUID->"348913e9-2695-43b4-8930-\
2049e5be48ef"],

Cell[TextData[{
 "Description of ROC curves. \nIn the case of likelihood ratio tests we use a \
",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Chi]", "2"], TraditionalForm]],ExpressionUUID->
  "3e800944-bbba-4d94-89dc-5314f7783408"],
 " distribution,  and the user will consider a false positive rate \[Alpha]  \
that they are willing to live with (e.g. 0.01 or 0.001, sometimes called \
\[OpenCurlyQuote]p values\[CloseCurlyQuote]).   Corresponding to that \
\[Alpha] there is a value ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "e67d44ea-3b08-492e-a431-22d6479a1002"],
 " from the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Chi]", "2"], TraditionalForm]],ExpressionUUID->
  "9e3bb4ec-c3d2-41a3-ae12-bcaafb686ded"],
 " that provides the area under the curve that is equal to \[Alpha],  meaning \
that is the observed test statistic is greater than ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "ec5307fc-044c-464e-b312-ecd4b35376d3"],
 " then the probability of observing a value as large as that or greater is \
less than or equal to \[Alpha]. \n\nTo generate the ROC curve in the case of \
a likelihood ratio test that uses a ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Chi]", "1", "2"], TraditionalForm]],ExpressionUUID->
  "51c56e10-3ee8-404c-965d-ca72dbc929d4"],
 "   distribution:\n1.  make a vector ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", " "}], TraditionalForm]],ExpressionUUID->
  "149143e7-f21f-4857-b767-e82c32a21635"],
 " that contains a set of threshold values.   These are drawn from the ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Chi]", "1", "2"], TraditionalForm]],ExpressionUUID->
  "0eba7aca-3bb2-44b2-a378-5c4abdda1820"],
 " distribution and span the range of ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Chi]", "1", "2"], TraditionalForm]],ExpressionUUID->
  "84d0e4d6-fae0-4186-af43-2a4848c14d98"],
 " values from ",
 Cell[BoxData[
  FormBox["0", TraditionalForm]],ExpressionUUID->
  "823dc413-011a-47e4-9c1e-0989552eeb55"],
 " to \[Infinity], corresponding to \[Alpha] values from 1 to 0.   for ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Chi]", "1", "2"], TraditionalForm]],ExpressionUUID->
  "7fc62378-b596-45aa-ae08-5496599d36d4"],
 " of 0,  all results are accepted, and for ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Chi]", "1", "2"], TraditionalForm]],ExpressionUUID->
  "7092b8eb-dd9d-4302-b1c5-1783d159ddbd"],
 "  of \[Infinity], none are accepted,  in between some will be accepted. \n\
2. Simulate a large set of data. The data to be simulated include a set of \
simulations for which the null model is True  and a set for which the null \
model is False (i.e. \[OpenCurlyQuote]Positives\[CloseCurlyQuote]) .  These \
are generated over a wide range of randomly picked parameter values for the \
parameter that is included in the alternative model (i.e. \[Gamma] in our \
case).  For the basic PRF model,  we need a set of null model SFSs (i.e. \
\[Gamma]=0 (the \[OpenCurlyQuote]negatives\[CloseCurlyQuote]) and a set of \
selected SFSs with \[Gamma] drawn at random over some range less than 0 (i.e. \
the \[OpenCurlyQuote]positives\[CloseCurlyQuote]).  \n3. Calculate  \
\[CapitalDelta] the LLR statistic for each data set. \n4. Get False Positive \
(FP) rates. For each threshold value in ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "a0889ab7-471b-4c2e-b4bc-6edf20187583"],
 ", determine what proportion of the cases where \[Gamma]=0 pass the \
threshold.   These are false positives.  e.g. for threshold ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],ExpressionUUID->
  "e626b55a-22e0-4ad1-bc5e-7765a02e839a"],
 "  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["FP", "q"], "=", 
    FractionBox[
     RowBox[{
      RowBox[{
      "#", " ", "data", " ", "Null", " ", "datasets", " ", "with", " ", 
       "\[CapitalDelta]"}], ">", "q"}], 
     RowBox[{"#", " ", "Null", " ", "datasets"}]]}], TraditionalForm]],
  ExpressionUUID->"9adf573b-acaf-474d-9db3-2190222d7cf9"],
 "\n5. Get True Positive (TP) rates. For each threshold value in ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "a25a8410-6a1e-4b40-9896-2d58c3fca9a6"],
 ", determine what proportion of the cases where \[Gamma]<0 pass the \
threshold.   These are true positives.  e.g. for threshold ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],ExpressionUUID->
  "0d3bb195-bbac-4ad3-a503-fae2ab145a38"],
 "  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["TP", "q"], "=", 
    FractionBox[
     RowBox[{
      RowBox[{
      "#", " ", "data", "  ", "Positive", " ", "datasets", " ", "with", " ", 
       "\[CapitalDelta]"}], ">", "q"}], 
     RowBox[{"#", " ", "Poistive", " ", "datasets"}]]}], TraditionalForm]],
  ExpressionUUID->"d3457a50-c043-4533-87c5-bc94f63fc7d6"],
 "\n6. All the FP values and all the TP values  will be between 0 and 1 \
inclusive.  Plot the pairs of values as  points,  with FP values on the X \
axis and TP values on the Y axis. \n7. Integrate under the curve to a measure \
of the discriminatory ability. \n\nThe ROC  should not be a function of which \
particular threshold values are used,  so long as they span the range.  And \
it should not be a function of which parameter values are used in the \
positive cases. \n\n"
}], "Text",
 CellChangeTimes->{{3.896355283259555*^9, 3.8963558264154873`*^9}, {
  3.896355868239767*^9, 3.8963558813115587`*^9}, {3.8963559175198936`*^9, 
  3.896356508468404*^9}, {3.8963565442329617`*^9, 3.896356571188694*^9}, {
  3.896356615621002*^9, 
  3.8963566357973127`*^9}},ExpressionUUID->"22ec165f-1911-40ff-bd09-\
ed4a3fdb3e84"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SFS_power.py", "Section",
 CellChangeTimes->{{3.89635653105999*^9, 
  3.896356533091897*^9}},ExpressionUUID->"43812931-3bb1-41f5-bfd8-\
f402fb9697f5"],

Cell[TextData[{
 "This script runs a power analysis for both the basic PRF model and the \
Ratio model.  For a range of true values of \[Gamma] and an array ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bd2304d9-5389-45d0-8e34-98fc9df51bba"],
 " that contains a series of values from the ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Chi]", "1", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d2cab1ff-cd44-491d-959f-15b9a96e65bc"],
 " distribution that span the range of \[Alpha] values (i.e. false positive \
rates), the script estimates the proportion of time that a True Positive \
occurs. \n\nTo do this,  a large set of simulated data sets are generated for \
a given value of \[Gamma].  Each generates a test statistic \[CapitalDelta].  \
Then with these \[CapitalDelta] values  determine the fraction of data sets \
that are statistically significant  for each of the threshold values.  i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["TP", 
     RowBox[{"\[Gamma]", ",", "q"}]], "=", 
    FractionBox[
     RowBox[{
      RowBox[{
      "#", " ", "data", "  ", "datasets", " ", "for", " ", "\[Gamma]", " ", 
       "that", " ", "have", "  ", "\[CapitalDelta]"}], ">", "q"}], 
     RowBox[{"#", "  ", "datasets", " ", "for", " ", "\[Gamma]"}]]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2ef973a9-bd3d-4ded-85a5-6a53526746c3"],
 "\nBecause all of the positive cases are True Positives,  TP is just an \
estimate of the probability of detecting a true effect.  \nThen for each \
threshold value,  plot the true positive rate as a function of \[Gamma].\n\n\
The script generates sets of curves for both  the basic likelihood ratio test \
of selection for the PRF model under Fisher Wright  and for the likelihood \
ratio test of selection based on SFS ratios.  "
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.896356536116127*^9, 3.896356537492428*^9}, {
  3.896356788854478*^9, 3.8963568001024857`*^9}, {3.8963569861197696`*^9, 
  3.8963574802347894`*^9}},ExpressionUUID->"486e3269-57f7-4cf6-9dcd-\
74e68e7ef2bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SFS_estimator_bias_variance.py", "Section",
 CellChangeTimes->{{3.896444321822942*^9, 
  3.8964443282925124`*^9}},ExpressionUUID->"3c141950-6b85-4625-88f4-\
64037e74c3b1"],

Cell["\<\
This script generates boxplots that show the estimates over a range of \
\[Gamma] values. Bias and variance are very low. 

run time options:
usage: SFS_estimator_bias_variance.py [-h] [-a DATAFILENAME] [-d \
DENSITYOF2NS] [-f] -k NTRIALS [-l PLOTFILELABEL]
                                      [-m MAXI] -n N [-p] -q THETAS [-r] [-s \
SEED] [-t THETAN] [-w]

options:
  -h, --help        show this help message and exit
  -a DATAFILENAME   optional data file with simulated SFSs
  -d DENSITYOF2NS   gamma or lognormal, only if simulating a distribution of \
Ns, else single values of Ns are used
  -f                use folded SFS distribution
  -k NTRIALS        number of trials per parameter set
  -l PLOTFILELABEL  optional string for labelling plot file names
  -m MAXI           optional setting for the maximum bin index to include in \
the calculations
  -n N              sample size
  -p                simulate Fisher-Wright SFS, basic PRF
  -q THETAS         theta for selected sites
  -r                simulate Fisher-Wright RATIO, RATIOPRF
  -s SEED           random number seed (positive integer)
  -t THETAN         theta for neutral sites, optional, if -t is not specified \
then thetaN and thetaS are given by -q
  -w                use watterson estimator for thetaN\
\>", "Text",
 CellChangeTimes->{{3.8964443331664085`*^9, 3.896444372728924*^9}, {
  3.9019034838891163`*^9, 
  3.9019035140919256`*^9}},ExpressionUUID->"029cbd4a-4e26-4e5a-890e-\
736124551d63"],

Cell["\<\
This script was used to thoroughly test out the use of the ratio of normals \
approach for teh  lognormal and gamma distributions .  
In brief,  the lognormal worked best,  except  when both terms are less than \
1.  These curves have all the density and the mode near zero. \
\>", "Text",
 CellChangeTimes->{{3.901903524363015*^9, 3.901903577260355*^9}, {
  3.9019036681563225`*^9, 
  3.9019037265733867`*^9}},ExpressionUUID->"85880579-8cfa-48dd-ade9-\
227ac3635427"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1524, 783.5999999999999},
WindowMargins->{{3, Automatic}, {Automatic, 0.6}},
Magnification:>1.4 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ad4c250e-62ab-4db8-afec-1ef67c23baf8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 164, 3, 136, "Title",ExpressionUUID->"1603bf2d-a0c4-4a4d-8d3f-39e1292c55e9"],
Cell[747, 27, 1676, 28, 359, "Text",ExpressionUUID->"e831b98a-6ff8-4299-9a86-0bddc3548771"],
Cell[2426, 57, 1263, 20, 172, "Text",ExpressionUUID->"7011b62e-40df-4329-b111-5bf51e89fc2b"],
Cell[3692, 79, 1456, 26, 297, "Text",ExpressionUUID->"a006e748-31ff-4eb6-b7ce-fca060487ba8"],
Cell[5151, 107, 6564, 184, 408, "Text",ExpressionUUID->"da5db689-f8c7-47d8-b2d4-6516208eea92"],
Cell[CellGroupData[{
Cell[11740, 295, 332, 7, 160, "Chapter",ExpressionUUID->"502ac572-4179-45a6-8047-ffd205de4fe5"],
Cell[12075, 304, 1336, 26, 172, "Text",ExpressionUUID->"bbe9f06d-c3f8-41c6-bcf8-714907c8c5fb"],
Cell[13414, 332, 2011, 51, 258, "Text",ExpressionUUID->"9d119165-1dd9-426d-9599-508d2c7af1b7"],
Cell[15428, 385, 7292, 201, 739, "Text",ExpressionUUID->"2d82636e-4e84-430c-8d92-f2dac7f39f6f"],
Cell[CellGroupData[{
Cell[22745, 590, 162, 2, 63, "Subsubsection",ExpressionUUID->"d73cb3b0-593f-4cb7-9d55-c68d79e3dfe1"],
Cell[22910, 594, 472, 9, 110, "Text",ExpressionUUID->"1545e44e-f01b-4ead-82aa-c92164bf6d85"],
Cell[23385, 605, 972, 18, 172, "Text",ExpressionUUID->"1af86d43-db24-4e9c-82f4-8a92ccc6985a"]
}, Closed]],
Cell[CellGroupData[{
Cell[24394, 628, 237, 5, 50, "Subsubsection",ExpressionUUID->"b14de8df-be89-4b6d-b942-b73359ce90e1"],
Cell[24634, 635, 6642, 194, 520, "Text",ExpressionUUID->"163f74e2-07f3-4a2e-96ef-e1b00f5b9c8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31313, 834, 176, 3, 63, "Subsubsection",ExpressionUUID->"9d6dc7ef-bc64-4156-9f19-e296c3ea8f16"],
Cell[31492, 839, 6941, 192, 645, "Text",ExpressionUUID->"a2b1f92c-3ecf-434c-8ea4-9ecdcd706cad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38470, 1036, 428, 11, 93, "Section",ExpressionUUID->"9410a3a4-2a13-4959-8537-5cfe6af67d29"],
Cell[38901, 1049, 8053, 213, 510, "Text",ExpressionUUID->"8a37da2e-6fd7-402c-9674-73c520689e7d"],
Cell[46957, 1264, 1045, 27, 108, "Input",ExpressionUUID->"7ab11f54-aa9c-4684-a149-7f97c1c1fc87"],
Cell[48005, 1293, 1071, 31, 65, "Input",ExpressionUUID->"49fcb4c3-da92-491a-893a-1f2d77d21841"],
Cell[49079, 1326, 897, 24, 39, "Input",ExpressionUUID->"157770f8-2286-49a2-9490-a3c89ba8855a"],
Cell[49979, 1352, 693, 21, 65, "Input",ExpressionUUID->"965c4e6f-c08e-4d86-af4d-81670133e531"],
Cell[50675, 1375, 1263, 30, 94, "Input",ExpressionUUID->"3ab9c7c1-261f-4577-a22c-b019fbc13b44"],
Cell[51941, 1407, 360, 9, 39, "Input",ExpressionUUID->"1713956b-1656-4069-bfd1-8a2a5b28f841"],
Cell[52304, 1418, 944, 28, 66, "Input",ExpressionUUID->"bb05cacb-f224-4a65-98f3-5fc5d277baf9"],
Cell[CellGroupData[{
Cell[53273, 1450, 404, 8, 39, "Input",ExpressionUUID->"4c65a1a8-d735-40c6-a4bf-cd34bde596cf"],
Cell[53680, 1460, 243, 4, 63, "Output",ExpressionUUID->"8458d4e7-1558-4ede-95b8-e77c3e1ae04b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53960, 1469, 407, 9, 39, "Input",ExpressionUUID->"7bb9251e-3376-49c9-80d7-907a6f4b49db"],
Cell[54370, 1480, 261, 6, 63, "Output",ExpressionUUID->"1370e65d-ff34-4498-8207-091718cc9195"]
}, Open  ]],
Cell[54646, 1489, 152, 3, 39, "Input",ExpressionUUID->"db9600c2-a87a-4f17-a860-6735de916bf3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54835, 1497, 236, 4, 93, "Section",ExpressionUUID->"e494b141-e148-4766-8f52-41193e1dc916"],
Cell[55074, 1503, 2868, 76, 123, "Text",ExpressionUUID->"e188632e-187c-4983-b8d4-3aae70a6949a"],
Cell[CellGroupData[{
Cell[57967, 1583, 180, 3, 63, "Subsubsection",ExpressionUUID->"39c73e3d-6ac7-4dd0-8d57-58a30d24d272"],
Cell[58150, 1588, 5444, 166, 271, "Text",ExpressionUUID->"c636324b-d3f2-4fe8-8ea3-8cce312f6e6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63631, 1759, 180, 3, 63, "Subsubsection",ExpressionUUID->"6dfce641-f216-4742-8404-86839e71f016"],
Cell[63814, 1764, 5919, 168, 373, "Text",ExpressionUUID->"0386f70f-53d9-4010-a972-f6fca4dc31f3"],
Cell[CellGroupData[{
Cell[69758, 1936, 768, 23, 39, "Input",ExpressionUUID->"1a6654f6-e430-40bc-af29-897d29cb94a6"],
Cell[70529, 1961, 1342, 40, 67, "Output",ExpressionUUID->"3dbd2910-9600-431b-83ae-5f871a338850"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71932, 2008, 217, 5, 93, "Section",ExpressionUUID->"1a6bb85e-a3b8-497a-99b9-a6510d3e7610"],
Cell[72152, 2015, 880, 16, 110, "Text",ExpressionUUID->"6c1034d2-c185-427a-845a-ff2e699ca530"],
Cell[CellGroupData[{
Cell[73057, 2035, 397, 8, 99, "Subsubsection",ExpressionUUID->"9137cd80-2c91-4bbf-8e7b-214f948aacee"],
Cell[73457, 2045, 6465, 184, 542, "Text",ExpressionUUID->"14fcdef3-bb70-4a64-b970-655bab0c9b1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79959, 2234, 320, 7, 99, "Subsubsection",ExpressionUUID->"75eae659-5ab8-4774-a978-00867612c111"],
Cell[80282, 2243, 4195, 98, 502, "Text",ExpressionUUID->"449ebba4-68b4-4465-85ae-af0b363407a8"],
Cell[84480, 2343, 3524, 90, 164, "Text",ExpressionUUID->"30e93724-d4ad-4884-a678-57f0e8905f69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88041, 2438, 182, 3, 75, "Subsection",ExpressionUUID->"19b67809-122f-498c-9bc1-b22727a24624"],
Cell[88226, 2443, 3139, 93, 168, "Text",ExpressionUUID->"aeedbc04-0a96-427a-983f-cd1b0d82f89b"],
Cell[CellGroupData[{
Cell[91390, 2540, 238, 4, 63, "Subsubsection",ExpressionUUID->"0b9ecceb-4dff-41d5-8d7a-af103e7f9e98"],
Cell[91631, 2546, 4857, 123, 338, "Text",ExpressionUUID->"679d2cae-3092-4b6d-a642-e33e35ff1d8e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96525, 2674, 555, 12, 63, "Subsubsection",ExpressionUUID->"619a5269-47ac-41f6-8e94-22e93bc5d6c7"],
Cell[97083, 2688, 3283, 84, 267, "Text",ExpressionUUID->"f44d02cd-ac85-43b9-ba7a-5dc7cc60a92d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100415, 2778, 368, 9, 112, "Subsection",ExpressionUUID->"634987fd-e3d6-4fd7-884f-2e06e9075589"],
Cell[100786, 2789, 458, 8, 79, "Text",ExpressionUUID->"cba2d235-1d85-450d-beb4-99131f17c1e1"],
Cell[CellGroupData[{
Cell[101269, 2801, 275, 4, 63, "Subsubsection",ExpressionUUID->"86c1d177-40c7-44fa-8487-296a5bd4a6d3"],
Cell[101547, 2807, 481, 9, 79, "Text",ExpressionUUID->"12e8b4ae-af9a-47bc-9080-829ed10a9a84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102065, 2821, 177, 3, 63, "Subsubsection",ExpressionUUID->"6582c419-bf47-49c7-9a67-753cf3519e41"],
Cell[102245, 2826, 9237, 242, 832, "Text",ExpressionUUID->"bc81a6b4-03f9-4375-9d1a-9b876621c929"],
Cell[111485, 3070, 8675, 249, 771, "Text",ExpressionUUID->"bd612c75-75fe-4cc0-bdaa-c76858bb9728"],
Cell[120163, 3321, 444, 9, 39, "Input",ExpressionUUID->"afe4a451-8e8f-4fc1-9c30-1c1bca963c7c"],
Cell[120610, 3332, 1314, 37, 82, "Input",ExpressionUUID->"0518f4be-fbd3-4b1e-97e8-28e430950878"],
Cell[CellGroupData[{
Cell[121949, 3373, 261, 6, 39, "Input",ExpressionUUID->"328adada-8a05-4350-9a1a-a0c5331fed41"],
Cell[122213, 3381, 252, 6, 45, "Output",ExpressionUUID->"5f4ed0f2-57e1-4874-8766-23a1503c8939"]
}, Open  ]],
Cell[122480, 3390, 251, 5, 39, "Input",ExpressionUUID->"2cfcc38d-d163-461b-a407-e3f9cc3114b1"],
Cell[122734, 3397, 152, 3, 39, "Input",ExpressionUUID->"8f87be04-4fd0-4855-a2ff-4a9c344e37c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122923, 3405, 173, 3, 63, "Subsubsection",ExpressionUUID->"3596b9f5-daf2-4807-979b-06d1b8488405"],
Cell[123099, 3410, 4251, 123, 451, "Text",ExpressionUUID->"7c197c16-77ef-43db-ba64-d34b904af14d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127423, 3541, 451, 11, 95, "Chapter",ExpressionUUID->"1be03235-5c56-4720-a6c0-d90defe2a342"],
Cell[127877, 3554, 3262, 82, 141, "Text",ExpressionUUID->"b74e8a98-fbec-49d7-b4f4-0a8670332df4"],
Cell[131142, 3638, 606, 13, 79, "Text",ExpressionUUID->"42841424-d2c6-47f4-a159-be0b39474e62"],
Cell[131751, 3653, 2348, 43, 267, "Text",ExpressionUUID->"3eaad458-bdf0-4ca4-a664-fff0eb984ffa"],
Cell[CellGroupData[{
Cell[134124, 3700, 204, 3, 93, "Section",ExpressionUUID->"5dd444c0-37be-4cf9-a037-8d1aec134f22"],
Cell[134331, 3705, 4412, 86, 640, "Text",ExpressionUUID->"64290bbb-d8b7-4dee-9eb1-8151d3898ea0"],
Cell[CellGroupData[{
Cell[138768, 3795, 204, 3, 63, "Subsubsection",ExpressionUUID->"9c08d387-f583-4dc2-970f-bbdd948c013a"],
Cell[138975, 3800, 11275, 350, 562, "Text",ExpressionUUID->"ebdfd726-b28e-4ffb-b120-aeb19c32009e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150287, 4155, 178, 3, 63, "Subsubsection",ExpressionUUID->"6a33470c-bf48-46c2-9fef-ddc95646d95a"],
Cell[150468, 4160, 17354, 489, 700, "Text",ExpressionUUID->"f9aaf946-8ed0-45d5-9bdb-1c50efd447dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167859, 4654, 213, 3, 63, "Subsubsection",ExpressionUUID->"daaf6f84-4e28-4247-aebd-53e5f44353fb"],
Cell[168075, 4659, 991, 26, 141, "Text",ExpressionUUID->"e615844e-fbb7-403b-aa7c-f697952fc066"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169103, 4690, 364, 11, 63, "Subsubsection",ExpressionUUID->"2499ba42-b1e8-4680-ab7a-b2d6c479f125"],
Cell[169470, 4703, 2992, 74, 306, "Text",ExpressionUUID->"507e9054-d9c6-4e3e-92d2-a91dcb3acb8b"],
Cell[172465, 4779, 3332, 104, 128, "Text",ExpressionUUID->"5e546f93-b145-446f-9ccc-e5d6976e86e2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[175858, 4890, 214, 4, 95, "Chapter",ExpressionUUID->"9d52be41-29f5-4e5e-9d99-db2a8bfd7ec8"],
Cell[176075, 4896, 321, 7, 48, "Text",ExpressionUUID->"dc94894b-ad39-45ba-84e5-07bfaf299252"],
Cell[CellGroupData[{
Cell[176421, 4907, 170, 3, 93, "Section",ExpressionUUID->"47fe2c84-e688-41a6-af74-0fa8492b4fa4"],
Cell[176594, 4912, 1132, 23, 141, "Text",ExpressionUUID->"42713337-ca24-4e55-b2e5-2646b4a9c314"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177763, 4940, 214, 4, 93, "Section",ExpressionUUID->"d2c322ca-db77-441d-8703-fe74e6457d16"],
Cell[177980, 4946, 4917, 144, 566, "Text",ExpressionUUID->"99dafc6f-9049-4a50-8c34-0a5639d666e3"],
Cell[182900, 5092, 2938, 85, 215, "Text",ExpressionUUID->"4e9a6240-70cb-4ed7-a62f-10d669838653"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185875, 5182, 157, 3, 93, "Section",ExpressionUUID->"e0b15fc6-e298-467a-b61f-705358e5adc8"],
Cell[186035, 5187, 1098, 21, 297, "Text",ExpressionUUID->"348913e9-2695-43b4-8930-2049e5be48ef"],
Cell[187136, 5210, 5680, 126, 809, "Text",ExpressionUUID->"22ec165f-1911-40ff-bd09-ed4a3fdb3e84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192853, 5341, 156, 3, 93, "Section",ExpressionUUID->"43812931-3bb1-41f5-bfd8-f402fb9697f5"],
Cell[193012, 5346, 2172, 44, 369, "Text",ExpressionUUID->"486e3269-57f7-4cf6-9dcd-74e68e7ef2bf",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[195221, 5395, 177, 3, 93, "Section",ExpressionUUID->"3c141950-6b85-4625-88f4-64037e74c3b1"],
Cell[195401, 5400, 1493, 32, 672, "Text",ExpressionUUID->"029cbd4a-4e26-4e5a-890e-736124551d63"],
Cell[196897, 5434, 478, 9, 79, "Text",ExpressionUUID->"85880579-8cfa-48dd-ade9-227ac3635427"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

